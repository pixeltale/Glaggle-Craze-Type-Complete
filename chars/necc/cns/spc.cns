;---------------------------------------------------------------------------
; CTech S-C
[Statedef 900]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 900
facep2 = 1
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (Var(51)>1&&EnemyNear,StateType!=S&&EnemyNear,StateType!=C)

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 2
x = ifelse(Var(5),min(8,P2Dist X * 0.025),max(1,min(3,P2Dist X * 0.033)))
y = -5
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemNo(0) = [2,8]
trigger1 = Var(5)
x = min(6,EnemyNear,Vel X * Facing * EnemyNear,Facing)
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) = [2,8]
y = 0.4 + 0.4 * (AnimElemNo(0) >= 6)
[State 0, VelMul]
type = VelSet
trigger1 = AnimElem = 9
x = 0
y = 0

[State 0, PosSet]
type = PosSet
trigger1 = AnimElem = 9
y = 0

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 2
value = F2, 3
[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 6
value = F0, 3
[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 9
value = F7, 0

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 2
v = 33
value = 900
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 2
v = 34
value = random%6

[State 0, Explod BigDust FX]
type = Explod
trigger1 = AnimElem = 2
;trigger1 = Var(5)
anim = F85
pos = 0,-Pos Y
postype = p1
ownpal = 1
sprpriority = -1
[State 0, Explod Dust Fwd]
type = Explod
trigger1 = AnimElem = 9
anim = F84
pos = 24,4
postype = p1
facing = -1+(2*random%2)
vel = (20+random%10)*0.1,(-20-random%10)*0.1
accel = -0.05,0.15
sprpriority = 4
ownpal = 1
[State 0, Explod Dust Back]
type = Explod
trigger1 = AnimElem = 9
anim = F84
pos = 16,4
postype = p1
facing = -1+(2*random%2)
vel = (-20-random%10)*0.1,(-20-random%10)*0.1
accel = 0.05,0.15
sprpriority = 4
ownpal = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 136

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = A,SA
hitflag = MAF
guardflag = HA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipMid))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleHeavy))
pausetime = 12,12+Var(13)
guard.pausetime = 12,12
sparkno = ifelse(Var(10)=2||Var(11)>=2&&EnemyNear,StateType!=A,30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = 40
sparkxy = -40+Floor(P2Dist X*0.5),-40+Floor(P2Dist Y*0.5)
hitsound = 1,3
guardsound = 5,1
ground.type = Low
ground.slidetime = 19
ground.hittime = 19
guard.hittime = 13
yaccel = 0.5
fall = (Var(11)>1||Var(10)=2)
air.fall = 1
ground.velocity = -4,0
air.velocity = -3,-3.5 - 1.5 * Var(5)
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = EnemyNear,StateType = L
attr = A,SA
hitflag = MAFD
damage = Ceil(Var(12) * FVar(10) * 0.25 + 8),Ceil(Var(12)*const(BC.ChipMid))
pausetime = 12,12
sparkno = 10 + random%4
sparkxy = -40+Floor(P2Dist X*0.5),-8+Floor(P2Dist Y*0.5)
hitsound = 1,3
ground.type = Low
ground.slidetime = 19
ground.hittime = 19
yaccel = 0.5
fall = 1
down.velocity = -0.5,-3
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, TargetState]
type = TargetState
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
trigger1 = Var(8) = 1
trigger1 = Var(10) != 2
trigger1 = EnemyNear,StateType = A
value = 5355
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
triggerall = Var(10) = 2 || Var(11) > 1 && EnemyNear,StateType != A
trigger1 = Var(8) = 1
map = "DireAct"
value = 5345
ignorehitpause = 1

[State 0, Var Gauge Gain]
type = VarAdd
trigger1 = Var(8) = 1 && MoveHit && NumTarget
v = 18
value = 100
ignorehitpause = 1

[State 0, Var Shake]
type = VarSet
trigger1 = AnimElem = 9
v = 9
value = 4

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 9
statetype = S
physics = S
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 10
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 12
value = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; CTech S-L
[Statedef 910]
type    = S
movetype= A
physics = N
movehitpersist = 1
ctrl = 0
anim = 910
velset = 0,0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 0
[State 0, VarSet]
type = VarSet
triggerall = !Var(5)
triggerall = Time > 2
trigger1 = map(b_x) && !map(b_a) || map(b_y)
trigger2 = Var(15) && Random < 500
v = 5
value = 911
[State 0, VarSet]
type = VarSet
triggerall = !Var(5)
triggerall = Time > 2
trigger1 = map(b_a) && !map(b_x)
trigger2 = Var(15) && Random < 500
v = 5
value = 912
[State 0, VarSet]
type = VarSet
triggerall = !Var(5)
triggerall = Time > 2
trigger1 = map(b_b)
trigger2 = Var(15) && Random < 500
v = 5
value = 913
[State 0, VarSet]
type = VarSet
triggerall = !Var(5) || Var(5) = 911 || Var(5) = 912
triggerall = Time > 2
trigger1 = map(b_x) && map(b_a)
trigger2 = Var(15) && Random < 500 && P2BodyDist X < 16
v = 5
value = 1200

[State 0, AttackDist]
type = AttackDist
trigger1 =  1
value = 0

[State 0, VelAdd]
type = VelAdd
trigger1 = Time = [3,5]
x = 2
[State 0, VelMul]
type = VelMul
trigger1 = Time = [11,12]
x = 0.85

[State 0, Var Voice Bank]
type = VarSet
trigger1 = Random > 500
trigger1 = AnimElem = 2
v = 33
value = 910
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 2
v = 34
value = random%4

[State 0, MapSet]
type = MapSet
trigger1 = AnimElem = 2
map = "DashDustFX"
value = 1
[State 0, Explod Step FX]
type = Explod
trigger1 = AnimElem = 2
trigger2 = AnimElem = 5
trigger3 = AnimElem = 8
anim = 915
pos = -24,-Pos Y
postype = p1
ownpal = 1
sprpriority = -1

[State 0, ChangeState]
type = ChangeState
trigger1 = Time >= 8
trigger1 = Var(5) = [910,1200] && Var(5) != 911
trigger2 = Time >= 12
trigger2 = Var(5) = [910,1200]
value = Var(5)
[State 0, ChangeState]
type = ChangeState
trigger1 = Time > 32
value = 911

;---------------------------------------------------------------------------
; CTech S-L, P
[Statedef 911]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 911
sprpriority = 2

[State 0, VelMul]
type = VelMul
trigger1 = !Time
x = 0.5

[State 0, AttackDist]
type = AttackDist
trigger1 =  1
value = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; CTech S-L, LK
[Statedef 912]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 912
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1301
v = 5
value = 0

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 3
value = F0,4
[State 0, Snd BONES]
type = PlaySnd
trigger1 = AnimElem = 3
value = 215,0

[State 0, Var Voice Bank]
type = VarSet
trigger1 = Random > Var(35)
trigger1 = AnimElem = 4
v = 33
value = 912
[State 0, Var Voice Variant]
type = VarSet
trigger1 = Random > Var(35)
trigger1 = AnimElem = 4
v = 34
value = random%4

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
x = 8
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 9
x = -8

[State 0, Var Damage Value]
type = VarSet
trigger1 = !MoveContact && !MoveReversed
v = 12
value = 104

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = C,SA
hitflag = MAF
guardflag = LA
animtype = light
priority = 4,Hit
damage = Floor(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleLight))
pausetime = 6,6+Var(13)
guard.pausetime = 12,12
sparkno = 5 + random%4 + (Var(10)=1) * 5
guard.sparkno = var(19)
sparkxy = -16,-24+Floor(P2Dist Y*0.5)
hitsound = 1,1
guardsound = 5,0
ground.type = High
ground.slidetime = 24
ground.hittime = 24
guard.hittime = 14
yaccel = 0.5
forcenofall = 1
ground.velocity = 0,0
air.velocity = 0,0
guard.velocity = -4
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(8) = 1 && Var(10) = 2
v = 11
value = 3
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = MoveHit = 1
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
value = 1320
[State 0, TargetState]
type = ChangeState
triggerall = NumTarget
trigger1 = MoveHit = 1
trigger1 = Target,MoveType = H && Target,StateNo = 1320
value = 1310

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 5, 1
movetype = I

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; CTech S-L, SK
[Statedef 913]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 900
sprpriority = 2

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 2
x = max(1,min(3,P2Dist X * 0.033))
y = -5
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) = [2,8]
y = 0.4 + 0.4 * (AnimElemNo(0) >= 6)
[State 0, VelMul]
type = VelSet
trigger1 = AnimElem = 9
x = 0
y = 0

[State 0, PosSet]
type = PosSet
trigger1 = AnimElem = 9
y = 0

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 2
value = F2, 3
[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 6
value = F0, 3
[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 9
value = F7, 0

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 3
v = 33
value = 913
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 3
v = 34
value = random%4

[State 0, Explod Dust Fwd]
type = Explod
trigger1 = AnimElem = 9
anim = F84
pos = 24,4
postype = p1
facing = -1+(2*random%2)
vel = (20+random%10)*0.1,(-20-random%10)*0.1
accel = -0.05,0.15
sprpriority = 4
ownpal = 1
[State 0, Explod Dust Back]
type = Explod
trigger1 = AnimElem = 9
anim = F84
pos = 16,4
postype = p1
facing = -1+(2*random%2)
vel = (-20-random%10)*0.1,(-20-random%10)*0.1
accel = 0.05,0.15
sprpriority = 4
ownpal = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 136

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = A,SA
hitflag = MAF
guardflag = HA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipMid))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleHeavy))
pausetime = 12,12+Var(13)
guard.pausetime = 12,12
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = 40
sparkxy = -40+Floor(P2Dist X*0.5),-40+Floor(P2Dist Y*0.5)
hitsound = 1,3
guardsound = 5,1
ground.type = Low
ground.slidetime = 19
ground.hittime = 19
guard.hittime = 13
yaccel = 0.5
fall = (Var(11)>1||Var(10)=2)
air.fall = 1
ground.velocity = -4,0
air.velocity = -3,-3.5 - 1.5 * Var(5)
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = EnemyNear,StateType = L
attr = A,SA
hitflag = MAFD
damage = Ceil(Var(12) * FVar(10) * 0.5 + 16),Ceil(Var(12)*const(BC.ChipMid))
pausetime = 12,12
sparkno = ifelse(Var(11)>=2,30,10 + random%4)
sparkxy = -40+Floor(P2Dist X*0.5),-8+Floor(P2Dist Y*0.5)
hitsound = 1,3
ground.type = Low
ground.slidetime = 19
ground.hittime = 19
yaccel = 0.5
fall = 1
down.velocity = -0.5,-4
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, TargetState]
type = TargetState
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
trigger1 = Var(8) = 1
trigger1 = Var(10) != 2
trigger1 = EnemyNear,StateType = A || EnemyNear,StateType = L
value = 5355
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
triggerall = Var(10) = 2 || Var(11) > 1 && EnemyNear,StateType != A
trigger1 = Var(8) = 1
map = "DireAct"
value = 5345
ignorehitpause = 1

[State 0, Var Gauge Gain]
type = VarAdd
trigger1 = Var(8) = 1 && MoveHit && NumTarget
v = 18
value = 200
ignorehitpause = 1

[State 0, Var Shake]
type = VarSet
trigger1 = AnimElem = 9
v = 9
value = 4

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 9
statetype = S
physics = S
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 10
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 12
value = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; CTech S-K
[Statedef 920]
type    = S
movetype= A
physics = N
movehitpersist = 1
ctrl = 0
anim = 920
velset = 0,0
sprpriority = 2

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0

[State 0, FX Big Light]
type = MapSet
trigger1 = AnimElem = 4
map = "NeccPal"
value = 4 + Map(NeckDoll)
[State 0, Snd Big Light]
type = PlaySnd
trigger1 = AnimElem = 4 && !Var(51)
trigger1 = Map(NeckDoll) = 8 && !Map(NeckDollBig)
value = S1600,1
[State 0, MapAdd]
type = MapSet
trigger1 = AnimElem = 4 && !Var(51)
trigger1 = Map(NeckDoll) = 8 && !Map(NeckDollBig)
map = "NeckDollBig"
value = 1

[State 0, MapAdd]
type = MapSet
trigger1 = AnimElem = 1 || animelem = 2 || animelem = 4 || animelem = 5
map = "NeckDoll"
value = min(8,Map(NeckDoll)+1)

[State 0, Var Voice Bank]
type = VarSet
trigger1 = !Time
trigger1 = Random*0.1 > Var(35)
v = 33
value = 920
[State 0, Var Voice Variant]
type = VarSet
trigger1 = !Time
trigger1 = Random*0.1 > Var(35)
v = 34
value = random%2

[State 0, Snd Halo]
type = PlaySnd
trigger1 = Time = 4
trigger1 = !(Map(NeckDoll) = 8 && !Map(NeckDollBig))
value = S2400,0
[State 0, Explod Halo]
type = Explod
trigger1 = !Time
anim = 2410
ID = 3000
postype = p1
bindtime = 8
sprpriority = -5
ownpal = 1
removeongethit = 1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 7
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; QCF+LP
[Statedef 1000]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 1000 + 5 * (PrevStateNo=1001)
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1001
v = 5
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = Time = 4
v = 6
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = Time >= 4
trigger1 = map(b_x) || map(b_y)
v = 6
value = 1
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 48 - 16 * (Anim%10 = 5)
[State 0, VarAdd]
type = VarAdd
triggerall = !MoveContact
trigger1 = AnimElemNo(0) = [5,7]
v = 7
value = 20 - 4 * (Anim%10 = 5)
[State 0, VarSet]
type = VarSet
trigger1 = MoveContact = 1
trigger1 = !Var(5)
v = 7
value = min(104,P2Dist X - 8)
ignorehitpause = 1
[State 0, VarSet]
type = VarSet
trigger1 = MoveContact = 1
trigger1 = Var(5)
v = 7
value = min(80,P2Dist X - 8)
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = !(Anim%5)
trigger1 = MoveContact && AnimElemNo(0) = [5,7]
value = Anim
elem = 8
[State 0, ChangeAnim]
type = ChangeAnim
triggerall = !(Anim%5)
trigger1 = AnimElem = 8
trigger1 = MoveHit && NumTarget
value = Anim + 1

[State 0, Snd Swing]
type = PlaySnd
trigger1 = !(Anim%5) && AnimElem = 3
value = F0,4
[State 0, Snd BONES]
type = PlaySnd
trigger1 = !(Anim%5) && AnimElem = 3
value = 215,0
[State 0, Snd Swing]
type = PlaySnd
trigger1 = Anim%5 && AnimElem = 3
value = F2,3

[State 0, Var Voice Bank]
type = VarSet
trigger1 = !(Anim%5) && AnimElem = 2
v = 33
value = 1000
[State 0, Var Voice Variant]
type = VarSet
trigger1 = !(Anim%5) && AnimElem = 2
v = 34
value = random%4

[State 0, Explod]
type = Explod
triggerall = Anim = 1000
trigger1 = AnimElemNo(0) = [4,9]
anim = 1010 + 3 * (AnimElemNo(0)>=8) + 3 * (AnimElemNo(0)>=9) + (Var(7)>64) + (Var(7)>80)
ID = 3000
pos = Var(7),-52
postype = p1
bindtime = 1
removetime = 1
scale = 1,1
sprpriority = 1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
triggerall = Anim = 1005
trigger1 = AnimElemNo(0) = [4,9]
anim = 1020 + 3 * (AnimElemNo(0)>=8) + 3 * (AnimElemNo(0)>=9) + (Var(7)>48) + (Var(7)>64)
ID = 3000
pos = Var(7),-60 - (Var(7)*0.65)
postype = p1
bindtime = 1
removetime = 1
scale = 1,1
sprpriority = 1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
triggerall = Anim%5
trigger1 = AnimElemNo(0) = 1 && Time < 4
anim = 1016 + (Var(7)>64) + (Var(7)>80)
ID = 3000
pos = Var(7),-52
postype = p1
bindtime = 1
removetime = 1
scale = 1,1
sprpriority = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 120

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = Anim = 1000
attr = S,SA
hitflag = MAF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleMid))
pausetime = 12,12
guard.pausetime = 12,12
sparkno = ifelse((Var(10)=2||Var(11)>=2),30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = 40
sparkxy = -16,-52+Floor(P2Dist Y*0.5)
hitsound = 1,2
guardsound = 5,1
ground.type = Low
ground.slidetime = 21
ground.hittime = 21
guard.hittime = 14
yaccel = 0.5
forcenofall = 1
ground.velocity = -1,0
air.velocity = -3,-3
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = Anim = 1005
attr = S,SA
hitflag = AF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
pausetime = 12,12
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,10 + random%4 + (Var(10)=1) * 5)
sparkxy = -16,-52+Floor(P2Dist Y*0.5)
hitsound = 1,2
ground.type = Low
air.hittime = 21
yaccel = 0.5
forcenofall = 1
air.velocity = -1,-1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, VarAdd P.Life Reduction]
type = VarAdd
triggerall = NumTarget
trigger1 = MoveHit
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
v = 22
value = -ceil(EnemyNear,Var(12) * const(BC.GetHitPLife))
redirectid = Target,ID
ignorehitpause = 1
[State 0, VarAdd Lucid Meter Gain]
type = VarAdd
triggerall = NumTarget
trigger1 = MoveHit
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
v = 18
value = floor(EnemyNear,Var(12) * const(BC.GetHitGaugeGain) * FVar(18))
redirectid = Target,ID
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(8) = 1 && Var(10) = 2
v = 11
value = 3
ignorehitpause = 1
[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = MoveHit
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
value = 1020 + (Var(11)>1)
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(11) > 1 && Anim%5 && AnimElem = 2
map = "DireAct"
value = Var(11) - 1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = !(Anim%5) && AnimElem = 8
trigger2 = Anim%5 && AnimElem = 2
movetype = I
[State 0, CtrlSet]
type = CtrlSet
trigger1 = Anim%5 && AnimElem = 7
value = 1

[State 0, ChangeState]
type = ChangeState
triggerall = Anim%5 && AnimElem = 2
trigger1 = MoveHit && NumTarget
trigger1 = Var(6)
trigger1 = Target,StateNo != 1021
value = 1060
[State 0, ChangeState]
type = ChangeState
triggerall = Anim%5 && AnimElem = 5
triggerall = Name = "NECC"
trigger1 = command = "holdy" && command = "holdb" || command = "holdc"
value = 900
[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; QCF+SP
[Statedef 1001]
type    = S
movetype= A
physics = S
ctrl = 0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1000

;---------------------------------------------------------------------------
; QCF+P V
[Statedef 1020]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0, VelSet]
type = VelSet
trigger1 = HitShakeOver
trigger1 = Vel X + Vel Y = 0
x = P2Dist X * 0.0675
y = (Pos Y * -0.01)

[State 0, VelAdd]
type = VelAdd
trigger1 = HitShakeOver
trigger1 = Pos Y < 0
y = 0.5
[State 0, PosSet]
type = PosSet
trigger1 = Pos Y + Vel Y > 0
y = 0
[State 0, VelSet]
type = VelSet
trigger1 = Pos Y >= 0
trigger1 = Vel Y != 0
y = 0
[State 0, VelMul]
type = VelMul
trigger1 = 1
x = 0.8 + (P2Dist X * 0.0015)

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Pos Y + Vel Y >= 0
trigger1 = StateType = A
statetype = S

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = Time <= 16
value = 5017

[State 0, SelfState]
type = SelfState
trigger1 = HitOver
trigger1 = StateType = S
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; QCF+P Crumple V
[Statedef 1021]
type    = A
movetype= H
physics = N
velset = P2Dist X * 0.075,(Pos Y * -0.025)
ctrl = 0
sprpriority = 1

[State 0, VelAdd]
type = VelAdd
trigger1 = Pos Y < 0
y = 0.5
[State 0, PosSet]
type = PosSet
trigger1 = Pos Y + Vel Y > 0
y = 0
[State 0, VelSet]
type = VelSet
trigger1 = Pos Y >= 0
trigger1 = Vel Y != 0
y = 0
[State 0, VelMul]
type = VelMul
trigger1 = 1
x = 0.8 + (P2Dist X * 0.0015)

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Pos Y + Vel Y >= 0
trigger1 = StateType = A
statetype = S

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = Time < 8
value = 5017
[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = Time = 8
value = 5325

[State 0, SelfState]
type = SelfState
trigger1 = AnimTime = 0
value = 5105

;---------------------------------------------------------------------------
; ju.QCF+LP
[Statedef 1050]
type    = A
movetype= A
physics = N
ctrl = 0
;velset = 0,0
anim = 1050 + 5 * (PrevStateNo=1051)
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 1
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1051
v = 5
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 48 - 16 * (Anim%10 = 5)
[State 0, VarAdd]
type = VarAdd
triggerall = !MoveContact
trigger1 = AnimElemNo(0) = [5,7]
v = 7
value = 20 - 4 * (Anim%10 = 5)
[State 0, VarSet]
type = VarSet
trigger1 = MoveContact = 1
trigger1 = !Var(5)
v = 7
value = min(104,P2Dist X - 8)
ignorehitpause = 1
[State 0, VarSet]
type = VarSet
trigger1 = MoveContact = 1
trigger1 = Var(5)
v = 7
value = min(80,P2Dist X - 8)
ignorehitpause = 1

[State 0, VelMul]
type = VelMul
trigger1 = !Time 
x = 0.001
y = 0.001

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = MoveContact && AnimElemNo(0) = [5,7]
value = Anim
elem = 8

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 3
value = F0,4
[State 0, Snd BONES]
type = PlaySnd
trigger1 = AnimElem = 3
value = 215,0

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 2
v = 33
value = 1000
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 2
v = 34
value = random%4

[State 0, Explod]
type = Explod
triggerall = Anim = 1050
trigger1 = AnimElemNo(0) = [4,9]
anim = 1010 + 3 * (AnimElemNo(0)>=8) + 3 * (AnimElemNo(0)>=9) + (Var(7)>64) + (Var(7)>80)
ID = 3000
pos = Var(7),-52
postype = p1
bindtime = 1
removetime = 1
scale = 1,1
sprpriority = 1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
triggerall = Anim = 1055
trigger1 = AnimElemNo(0) = [4,9]
anim = 1060 + 3 * (AnimElemNo(0)>=8) + 3 * (AnimElemNo(0)>=9) + (Var(7)>48) + (Var(7)>64)
ID = 3000
pos = 12 + Var(7),-44 + (Var(7)*0.65)
postype = p1
bindtime = 1
removetime = 1
scale = 1,1
sprpriority = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 120

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = A,SA
hitflag = MAF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleMid))
pausetime = 12,12
guard.pausetime = 12,12
sparkno = 10 + random%4 + (Var(10)=1) * 5
guard.sparkno = 40
sparkxy = -16,-52+Floor(P2Dist Y*0.5)
hitsound = 1,2
guardsound = 5,1
ground.type = Low
ground.slidetime = 21
ground.hittime = 21
guard.hittime = 12
yaccel = 0.5
air.fall = 1
ground.velocity = -1,0
air.velocity = -3,-3
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(8) = 1 && Var(10) = 2
v = 11
value = 2
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 8
movetype = I
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 9
physics = A
[State 0, VelMul]
type = VelMul
trigger1 = AnimElem = 9
x = 250
y = 500
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElem = 9
x = 2

[State 0, ChangeState]
type = ChangeState
trigger1 = AnimElem = 8
trigger1 = MoveHit && NumTarget
value = 1060
[State 200, 3]
type = ChangeState
trigger1 = Pos Y + Vel Y > Map(StageGround)
value = 1415

;---------------------------------------------------------------------------
; ju.QCF+SP
[Statedef 1051]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1050

;---------------------------------------------------------------------------
; ju.QCF+P S
[Statedef 1060]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 3
anim = 1070 + (Anim%10&&PrevStateNo=1050)

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = !Time
value = 1070

[State 0, Width]
type = Width
trigger1 = 1
edge = min(64,Time*2),0

[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 1 && AnimTime
time = 1
pos = (P2Dist X + 72) * 0.5,(P2Dist Y + 24 * (Anim=1071)) * 0.5
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 2
time = 1
pos = 32,-24
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 3
time = 1
pos = -40,-44
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 4
time = 1
pos = -48,-68
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 5
time = 1
pos = -28,-90
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 6
time = 1
pos = 0,-92
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 7
time = 1
pos = 32,-86
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 8
time = 1
pos = 64,0

[State 0, VelSet]
type = VelSet
trigger1 = !Time
x = -1 - (EnemyNear,BackEdgeDist < 16) + FrontEdgeDist * 0.02
y = -6.25 - Pos Y * 0.025
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) < 8 && AnimTime
y = 0.5

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 8
x = 0
y = 0
[State 0, PosSet]
type = PosSet
trigger1 = AnimElem = 8
y = 0

[State 210, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 2
value = F0, 4
[State 0, Snd SLAM]
type = PlaySnd
trigger1 = AnimElem = 8
value = F7,1
[State 0, Snd BLAM]
type = PlaySnd
trigger1 = AnimElem = 8
value = F1,4

[State 0, Explod HitGround]
type = Explod
trigger1 = AnimElem = 8
anim = F62
pos = p2dist x,0
postype = p1
sprpriority = -1
ownpal = 1
[State 0, Explod HitSpark H]
type = Explod
trigger1 = AnimElem = 8
anim = F15 + random%4
pos = p2dist x,-8
postype = p1
sprpriority = 9
supermovetime = 666
ontop = 1
ownpal = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = AnimElem = 3
value = 1
[State 0, SprPriority]
type = SprPriority
trigger1 = AnimElem = 8
value = 3

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 8
v = 9
value = 12

[State 0, Var HitAdd]
type = VarAdd
trigger1 = AnimElem = 8
v = 51
value = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = AnimElem = 8
v = 12
value = 8 + Ceil(16 * FVar(10))
[State 0, LifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 8
value = -Var(12)

[State 0, PowerAdd]
type = PowerAdd
trigger1 = AnimElem = 8
value = Ceil(Var(12) * Map(ScaledPowerGetHit))
[State 0, PowerAdd]
type = TargetPowerAdd
trigger1 = AnimElem = 8
value = Ceil(Var(12) * Map(ScaledPowerGiveHit))
[State 0, VarAdd P.Life Reduction]
type = VarAdd
trigger1 = AnimElem = 8
v = 22
value = -ceil(EnemyNear,Var(12) * const(BC.GetHitPLife))
redirectid = Target,ID
[State 0, VarAdd Lucid Meter Gain]
type = VarAdd
trigger1 = AnimElem = 8
v = 18
value = floor(EnemyNear,Var(12) * const(BC.GetHitGaugeGain) * FVar(18))
redirectid = Target,ID

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 13
value = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 8
statetype = S
physics = S

[State 0, ChangeState]
type = ChangeState
triggerall = AnimElem = 13
triggerall = Name = "NECC"
trigger1 = command = "holdy" && command = "holdb" || command = "holdc"
value = 900
[State 0, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; ju.QCF+P V
[Statedef 1070]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = ifelse(EnemyNear,Pos Y >= -8,-2.75,-4.5)

[State 0, NotHitBy]
type = NotHitBy
trigger1 = Anim = 1080 && AnimElemNo(0) <= 7
value = SCA
time = 1
[State 0, ScreenBound]
type = ScreenBound
trigger1 = Anim != 5400
value = Time>17
movecamera = 0,0

[State 0, VelSet]
type = VelSet
trigger1 = Anim = 1080 && !AnimTime
x = ifelse(Var(5)>=-3,-2.5,P2Dist X * 0.02)
y = Var(5)
[State 0, VelAdd]
type = VelAdd
trigger1 = Anim = 5400
y = 0.5

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !Time
value = 1080
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim = 1080 && !AnimTime
value = 5400

[State 0, VarSet]
type = VarSet
trigger1 = !Time
sysvar(2) = 0

[State 0, SelfState]
type = SelfState
trigger1 = Anim = 5400
trigger1 = Pos Y + Vel Y > Map(StageGround)
value = 5105

;---------------------------------------------------------------------------
; QCB+LK
[Statedef 1100]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 1100 + (PrevStateNo=1101)
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1101
v = 5
value = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
x = 8

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 4
y = -2 - 1 * Var(5)
[State 0, VelSet]
type = VelAdd
trigger1 = AnimElemNo(0) = 4
x = 2 - 0.25 * Var(5)
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) >= 4
y = 0.225
[State 0, VelMul]
type = VelMul
trigger1 = AnimElemNo(0) >= 8
x = 0.95
[State 0, VelMul]
type = VelMul
trigger1 = MoveContact = 1 && !Var(5)
x = 0.66

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = F2, 3

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 4
v = 33
value = 1100
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 4
v = 34
value = random%4

[State 0, Explod BigDust FX]
type = Explod
trigger1 = AnimElem = 3
anim = F85
pos = 0,-Pos Y
postype = p1
ownpal = 1
sprpriority = -1

[State 0, Explod Slash FX 1]
type = Explod
trigger1 = AnimElemNo(0) = [4,7]
trigger1 = GameTime%3 = 0
anim = 1105 + (AnimElemNo(-(Var(8)!=0))-4)
ID = 3000
postype = p1
removetime = 1
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
[State 0, Explod Slash FX 2]
type = Explod
trigger1 = AnimElem = 7
anim = 1109
ID = 3000
postype = p1
bindtime = 4
sprpriority = 5
ownpal = 1
removeongethit = 0

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 136 + 8 * !!Var(5)

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = A,SA
hitflag = AF
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
pausetime = 12,12+Var(13)
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,10 + random%4 + (Var(10)=1) * 5)
sparkxy = -40+Floor(P2Dist X*0.5),-40+Floor(P2Dist Y*0.5)
hitsound = 1,3
ground.type = Low
ground.slidetime = 21
ground.hittime = 21
yaccel = 0.5
fall = 1
air.velocity = -3,-3 - 3 * Var(5)
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = AnimElemNo(0) >= 6
attr = A,SA
hitflag = MAF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleMid))
pausetime = 12,12+Var(13)
guard.pausetime = 12,12
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = 40
sparkxy = -40+Floor(P2Dist X*0.5),-40+Floor(P2Dist Y*0.5)
hitsound = 1,3
guardsound = 5,1
ground.type = Low
ground.slidetime = 21
ground.hittime = 21
guard.hittime = 15
yaccel = 0.5
fall = var(5)&&!(Var(11)>1||Var(10)=2)
air.fall = 1
ground.velocity = -4 + 2 * Var(5),-6 * Var(5)
air.velocity = -3 + Var(5),-4 - 1.5 * Var(5)
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
triggerall = Var(10) = 2 || Var(11) > 1
trigger1 = Var(8) = 1
map = "DireAct"
value = ifelse(EnemyNear,StateType=A,5340,5320)
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 4
statetype = A
physics = N
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 8
movetype = I

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 1415

;---------------------------------------------------------------------------
; QCB+SK
[Statedef 1101]
type    = S
movetype= A
physics = S
ctrl = 0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1100

;---------------------------------------------------------------------------
; 360+LP
[Statedef 1200]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 1200
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (PrevStateNo=1201)

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveType = A
v = 6
value = (Var(10)=2||Var(11)>=2)

[State 800, 1]
type = HitDef
trigger1 = Time = 3
trigger1 = P2BodyDist X = [-8,const(size.ground.front)*1.33333]
attr = S, ST
hitflag = M-
priority = 6, Miss
sparkno = 50
sparkxy = -8,-52
hitsound = F1, 9
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1210
p2stateno = 1220
numhits = 0
guard.dist = 0
[State 800, 1]
type = HitDef
trigger1 = Time = 3
trigger1 = EnemyNear,MoveType = H && EnemyNear,StateNo != [120,160)
attr = S, ST
hitflag = M+
priority = 6, Miss
sparkno = 50
sparkxy = -8,-52
hitsound = F1, 9
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1210
p2stateno = 1220
numhits = 0
guard.dist = 0

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 6
v = 33
value = 800
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 6
v = 34
value = random%3

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 4
movetype = I

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; 360+SP
[Statedef 1201]
type    = S
movetype= A
physics = S
ctrl = 0
sprpriority = 2

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1200

;---------------------------------------------------------------------------
; 360+P S
[Statedef 1210]
type    = A
movetype= A
physics = N
anim = 1210
velset = 0,0
sprpriority = -1

[State 0, Turn]
type = Turn
trigger1 = AnimElem = 6 && Var(5)
[State 0, Turn]
type = Turn
trigger1 = AnimElem = 6 && Var(5)
redirectid = Target,ID

[State 0, Width]
type = Width
trigger1 = Time < 53
edge = P2Dist X - EnemyNear,Vel X,0
[State 0, Width]
type = Width
trigger1 = Time > 53
edge = 32,0

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 9
trigger2 = AnimElem = 10
x = 8

[State 0, SprPriority]
type = SprPriority
trigger1 = AnimElem = 5
value = 3

[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = Time < 32  && AnimElemNo(0) < 5
trigger2 = AnimElem = 10
time = 1
pos = 32,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 5
time = 1
pos = 26,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 6
time = 1
pos = 0,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 7
time = 1
pos = -12,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 8
time = 1
pos = -16,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 9
time = 1
pos = 12,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElem = 15
time = 1
pos = 80,0

[State 210, Snd Coffin Summon]
type = PlaySnd
trigger1 = AnimElem = 6
value = 1200, 0
[State 210, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 9
trigger2 = AnimElem = 21
value = F0, 4
[State 210, Snd Door Slam]
type = PlaySnd
trigger1 = AnimElem = 12
value = 191, 0
[State 210, Snd Dash]
type = PlaySnd
trigger1 = AnimElem = 12, 2
trigger2 = AnimElem = 18
value = F2, 3
[State 0, Snd SLAM]
type = PlaySnd
trigger1 = AnimElem = 22, 4
value = F7,1
[State 0, Snd BLAM]
type = PlaySnd
trigger1 = AnimElem = 22, 4
value = F1,4
[State 210, Snd Coffin Break]
type = PlaySnd
trigger1 = AnimElem = 22, 4
value = 191, 1

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 5
v = 33
value = 1200
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 5
v = 34
value = random%4

[State 0, Explod BigDust FX]
type = Explod
trigger1 = AnimElem = 12, 2
anim = F85
postype = p1
ownpal = 1
sprpriority = -1
[State 0, Explod Coughin 1]
type = Explod
trigger1 = AnimElem = 6
anim = 1211
pos = min(-48 + FrontEdgeDist - ((CameraPos X * Facing) - 300),64),0
postype = p1
sprpriority = -3
shadow = -1
ownpal = 1
[State 0, Explod Coughin 1]
type = Explod
trigger1 = AnimElem = 15
anim = 1212
pos = -16,0
postype = p1
bindtime = 666
sprpriority = -3
shadow = -1
ownpal = 1
[State 0, Explod Coughin 2]
type = Explod
trigger1 = AnimElem = 21
anim = 1213
pos = -24,0
postype = p1
vel = 0,12
accel = 0,1
sprpriority = -3
shadow = -1
ownpal = 1
[State 0, Explod Coughin Break FX1]
type = Explod
trigger1 = AnimElem = 22, 4
anim = 1214
pos = p2dist x - 32,p2dist y + 8
postype = p1
vel = 0.01 * (-400+random%801),0.01 * (-300-random%601)
accel = 0,0.5
sprpriority = 3
removetime = 64
ownpal = 1
[State 0, Explod Coughin Break FX2]
type = Explod
trigger1 = AnimElem = 22, 4
anim = 1215
pos = p2dist x - 32,p2dist y + 8
postype = p1
vel = 0.01 * (-400+random%801),0.01 * (-300-random%601)
accel = 0,0.5
sprpriority = 3
removetime = 64
ownpal = 1
[State 0, Explod Coughin Break FX3]
type = Explod
trigger1 = AnimElem = 22, 4
anim = 1216
pos = p2dist x - 32,p2dist y + 8
postype = p1
vel = 0.01 * (-400+random%801),0.01 * (-300-random%601)
accel = 0,0.5
sprpriority = 3
removetime = 64
ownpal = 1
[State 0, Explod Coughin Break FX4]
type = Explod
trigger1 = AnimElem = 22, 4
anim = 1217
pos = p2dist x - 32,p2dist y + 8
postype = p1
vel = 0.01 * (-400+random%801),0.01 * (-300-random%601)
accel = 0,0.5
sprpriority = 3
removetime = 64
ownpal = 1
[State 0, Explod Coughin Break FX5]
type = Explod
trigger1 = AnimElem = 22, 4
anim = 1218
pos = p2dist x - 32,p2dist y + 8
postype = p1
vel = 0.01 * (-400+random%801),0.01 * (-300-random%601)
accel = 0,0.5
sprpriority = -3
removetime = 64
ownpal = 1
[State 0, Explod HitGround]
type = Explod
trigger1 = AnimElem = 22, 4
anim = F62
pos = p2dist x,p2dist y
postype = p1
sprpriority = -1
ownpal = 1
[State 0, Explod HitSpark H]
type = Explod
trigger1 = AnimElem = 22, 4
anim = F15 + random%4
pos = p2dist x,p2dist y - 16
postype = p1
sprpriority = 9
supermovetime = 666
ontop = 1
ownpal = 1

[State 0, VelSet]
type = VelAdd
trigger1 = AnimElemNo(0) = 13
x = P2Dist X * 0.045
[State 0, VelMul]
type = VelMul
trigger1 = AnimElemNo(0) = [13,14]
x = 0.8

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 15
x = 0
y = 0
[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 18
x = max(2,FrontEdgeDist*0.01)
y = -9
[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 21
x = 0.5
y = -6
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) = [18,20]
y = 0.4
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) >= 21
y = 0.4

[State 0, VarSet EnvShake]
type = VarSet
trigger1 = AnimElem = 22, 4
v = 9
value = 8

[State 0, HitAdd]
type = VarAdd
trigger1 = AnimElem = 22, 4
v = 51
value = 1

[State 0, VarSet Counter!]
type = VarSet
trigger1 = !Time
trigger1 = Var(10) > 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = !Time
trigger1 = Var(10) = 2
v = 11
value = 3
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = Var(11) > 1
trigger1 = AnimElem = 22, 4
map = "DireAct"
value = Var(11) - 1
ignorehitpause = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = AnimElem = 22, 4
v = 12
value = Ceil((176 + floor(Map(NecxCountdown) * 1.0)) * FVar(10)) + ceil(Map(NecxCountdown) * 1.0)
[State 0, LifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 22, 4
value = -Var(12)

[State 0, PowerAdd]
type = PowerAdd
trigger1 = AnimElem = 22, 4
value = Ceil(Var(12) * Map(ScaledPowerGetHit))
[State 0, PowerAdd]
type = TargetPowerAdd
trigger1 = AnimElem = 22, 4
value = Ceil(Var(12) * Map(ScaledPowerGiveHit))

[State 0, Var Gauge Gain]
type = VarAdd
trigger1 = AnimElem = 22, 4
trigger1 = Name = "NECX"
v = 18
value = Map(NecxCountdown) * 20
[State 0, Map Countdown Set]
type = MapSet
triggerall = Name = "NECX"
trigger1 = AnimElem = 22, 4
map = "NecxCountdown"
value = 0
ignorehitpause = 1
[State 0, Map Countdown Limit]
type = MapSet
triggerall = Name = "NECX"
trigger1 = AnimElem = 22, 4
map = "NecxCountoff"
value = Var(51)
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget;()
trigger1 = AnimElem = 22, 4
value = 1221
[State 0, TargetState]
type = TargetState
triggerall = NumTarget;()
trigger1 = AnimElem = 22, 5
trigger1 = RoundState > 2 && !Target,Alive
value = 5610

[State 0, NotHitBy]
type = NotHitBy
triggerall = Var(11) <= 1 && !Var(6)
trigger1 = Pos Y + Vel Y > Map(StageGround)
trigger2 = animtime = 0
value = SCA
time = 24
redirectid = Target,ID
[State 800, 2]
type = ChangeState
trigger1 = Pos Y + Vel Y > Map(StageGround)
trigger2 = animtime = 0
value = 1415

;---------------------------------------------------------------------------
; 360+P V1
[Statedef 1220]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !Time
value = 1220
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 1220
value = 5320
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Time >= 49
trigger1 = Anim != 666
value = 666

[State 0, VelSet]
type = VelSet
trigger1 = Time = [37,38]
x = -9
[State 0, VelMul]
type = VelMul
trigger1 = Anim = 5320
x = 0.9

[State 0, VelSet]
type = VelSet
trigger1 = Anim = 666
trigger1 = Vel X != 0
x = 0
y = 0

[State 0, VarSet]
type = VarSet
trigger1 = !Time
sysvar(2) = 0

;---------------------------------------------------------------------------
; 360+P V2
[Statedef 1221]
type    = A
movetype= H
physics = N
velset = 0,0
anim = 5080
sprpriority = 2

[State 0, Offset]
type = Offset
trigger1 = Time < 8
x = -1+random%3
y = -1+random%3

[State 0, VarAdd P.Life Reduction]
type = VarAdd
trigger1 = !Time
v = 22
value = -ceil(EnemyNear,Var(12) * const(BC.GetHitPLife))
ignorehitpause = 1
[State 0, VarAdd Lucid Meter Gain]
type = VarAdd
trigger1 = !Time
v = 18
value = floor(EnemyNear,Var(12) * const(BC.GetHitGaugeGain) * FVar(18))
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = Time = 8
x = -1; + 1 * EnemyNear,Var(6)
y = -6 - 3 * EnemyNear,Var(6)

[State 0, VarSet]
type = VarSet
trigger1 = !Time
sysvar(2) = 16

[State 0, SelfState]
type = SelfState
trigger1 = Time = 8
value = 5401

;---------------------------------------------------------------------------
; HCF+LK
[Statedef 1300]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 1300; + (PrevStateNo=1301)
sprpriority = 2

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (PrevStateNo=1301)
[State 0, VarSet]
type = VarSet
trigger1 = !MoveContact
v = 6
value = (EnemyNear,StateType=A)

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 3
value = F0,4
[State 0, Snd BONES]
type = PlaySnd
trigger1 = AnimElem = 3
value = 215,0

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 3
v = 33
value = 1300
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 3
v = 34
value = random%4

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
x = 8
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 9
x = -8

[State 800, 1]
type = HitDef
trigger1 = P2Dist X = [4,112]
attr = S, ST
hitflag = M-
priority = 1, Miss
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,50)
sparkxy = -8,-8
hitsound = F1, 9
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1310
p2stateno = 1320
numhits = 0
guard.dist = 0
fall = !(Var(10)=2||Var(11)>1)
forcenofall = (Var(10)=2||Var(11)>1)
[State 800, 1]
type = HitDef
trigger1 = EnemyNear,StateNo != [150,160) && EnemyNear,MoveType = H
attr = S, ST
hitflag = MAF+
priority = 1, Miss
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,50)
sparkxy = -8,-8
hitsound = F1, 9
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1310
p2stateno = 1320
numhits = 0
guard.dist = 0
fall = !(Var(10)=2||Var(11)>1)
forcenofall = (Var(10)=2||Var(11)>1)

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 5, 1
movetype = I

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HCF+SK
[Statedef 1301]
type    = S
movetype= A
physics = S
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1300

;---------------------------------------------------------------------------
; HCF+K S
[Statedef 1310]
type    = S
movetype= A
physics = N
anim = 1310
velset = 0,0
sprpriority = -1

[State 0, Width]
type = Width
trigger1 = 1
edge = 32,0

[State 0, Turn]
type = Turn
trigger1 = AnimElem = 3

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
x = 8

[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElemNo(0) = 3
time = 1
pos = -24,0
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = AnimElem = 3,2
time = 1
pos = 24,0

[State 0, HitAdd]
type = VarAdd
trigger1 = AnimElem = 3
v = 51
value = 1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = AnimElem = 4
value = ifelse(Var(11)>1&&Name!="NECX",5321,5391)
[State 0, VelSet]
type = TargetVelSet
triggerall = NumTarget
trigger1 = AnimElem = 4
x = -4
y = -0.5 * (Target,StateNo=5391)

[State 0, VarSet Counter!]
type = VarSet
trigger1 = !Time
trigger1 = Var(10) > 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = !Time
trigger1 = Var(10) = 2
v = 11
value = 3
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = Var(11) > 1
trigger1 = AnimElem = 4
trigger1 = Name != "NECX"
map = "DireAct"
value = Var(11) - 1
ignorehitpause = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = Ceil((144 - 120 * (Name="NECX")) * FVar(10))
[State 0, LifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 3
value = -Var(12)

[State 0, PowerAdd]
type = PowerAdd
trigger1 = AnimElem = 3
value = Ceil(Var(12) * Map(ScaledPowerGetHit))
[State 0, PowerAdd]
type = TargetPowerAdd
trigger1 = AnimElem = 3
value = Ceil(Var(12) * Map(ScaledPowerGiveHit))

[State 0, ChangeState]
type = ChangeState
triggerall = Name = "NECC"
triggerall = AnimElemNo(0) >= 9
trigger1 = command = "holdy" && command = "holdb" || command = "holdc"
value = 900

[State 0, Var Gauge Gain]
type = VarAdd
trigger1 = !Time
trigger1 = Name = "NECX"
v = 18
value = 200
ignorehitpause = 1

[State 0, CtrlSet]
type = CtrlSet
triggerall = AnimElem = 8
trigger1 = EnemyNear,StateNo = 5321
trigger2 = Name = "NECX"
value = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HCF+K V
[Statedef 1320]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 2

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !Time
value = 1320

[State 0, Turn]
type = Turn
trigger1 = AnimElem = 3

[State 0, VarAdd P.Life Reduction]
type = VarAdd
trigger1 = AnimElem = 3
v = 22
value = -ceil(EnemyNear,Var(12) * const(BC.GetHitPLife))
ignorehitpause = 1
[State 0, VarAdd Lucid Meter Gain]
type = VarAdd
trigger1 = AnimElem = 3
v = 18
value = floor(EnemyNear,Var(12) * const(BC.GetHitGaugeGain) * FVar(18))
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
sysvar(2) = 8

;---------------------------------------------------------------------------
; QCF+LK
[Statedef 1400]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 1400 + (PrevStateNo=1401)

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1401
v = 5
value = 0

[State 0, VarSet]
type = VarSet
trigger1 = !MoveContact
v = 6
value = (Var(10)=2||Var(11)>1)

[State 0, NotHitBy]
type = NotHitBy
trigger1 = AnimElemNo(0) = [2,3]
value = ,NT,ST,HT
time = 1
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 4
statetype = A
physics = N

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 4
value = F2, 3

[State 0, Explod BigDust FX]
type = Explod
trigger1 = AnimElem = 4
anim = F85
pos = 0,-Pos Y
postype = p1
ownpal = 1
sprpriority = -1

[State 0, VelSet]
type = VelAdd
trigger1 = AnimElemNo(0) = 4
x = 2 + 0.50 * Var(5)
[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 4
y = -2.00

[State 0, VelMul]
type = VelMul
trigger1 = AnimElemNo(0) >= 6
x = 0.975
[State 0, VelMul]
type = VelMul
trigger1 = AnimElemNo(0) = 9
x = 0.8

[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) >= 4
y = 0.2

[State 0, Var Damage Value]
type = VarSet
trigger1 = !MoveContact && !MoveReversed
v = 12
value = 88

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = S,SA
hitflag = MAF
guardflag = MA
animtype = light
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(152*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleLight))
pausetime = 12,12
sparkno = 5 + random%4 + (Var(10)=1) * 5
guard.sparkno = var(19)
sparkxy = -24+Floor(P2Dist X*0.5),-32+Floor(P2Dist Y*0.5)
hitsound = 1,1
guardsound = 5,0
ground.type = High
ground.slidetime = 24
ground.hittime = 24
guard.hittime = 18
yaccel = 0.5
forcenofall = 1
ground.velocity = 0,0
air.velocity = 0,0
guard.velocity = -4
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(8) = 1 && Var(10) = 2
v = 11
value = 3
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = MoveHit && Var(8) = 1
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
value = 5010
ignorehitpause = 1
[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = MoveHit && Var(8) = 1
trigger1 = Target,MoveType = H && Target,StateNo = 5010
time = 1
pos = 16 + P2Dist X * 0.50,-Pos Y
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
triggerall = NumTarget
trigger1 = MoveHit && (Target,StateNo = [5010,5020))
value = 1410

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 8
movetype = I

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 1415

;---------------------------------------------------------------------------
; QCF+SK
[Statedef 1401]
type    = S
movetype= A
physics = S
ctrl = 0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1400

;---------------------------------------------------------------------------
; QCF+K S
[Statedef 1410]
type    = A
movetype= A
physics = N
anim = 1410
velset = 0,0
sprpriority = 1

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 4
value = F0,3

[State 0, PosAdd]
type = PosAdd
trigger1 = Time = 1
x = P2Dist X * 0.125

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemNo(0) = 4
x = P2Dist X * 0.125
y = enemynear,const(size.head.pos.y) * 0.025

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 6
x = 0.5
y = -1
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) >= 6
y = 0.25

[State 0, Var Damage Value]
type = VarSet
trigger1 = !MoveContact && !MoveReversed
v = 12
value = 64

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = S,NA
hitflag = MAF+
;animtype = medium
;priority = 4,Hit
damage = Ceil(Var(12) * FVar(10))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleLight))
pausetime = 12,12+Var(13)
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,10 + random%4 + (Var(10)=1) * 5)
sparkxy = -24+Floor(P2Dist X*0.5),-32+Floor(P2Dist Y*0.5)
hitsound = 1,3
;ground.type = High
ground.slidetime = 24
ground.hittime = 24
yaccel = 0.5
fall = 1
ground.velocity = -2.5,-6
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = MoveHit && Var(8) = 1
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
trigger1 = Var(6) || Var(11) >= 3
value = 5330
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(11) > 1 && Var(8) = 1
map = "DireAct"
value = Var(11) - 1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 6
movetype = I

[State 210, 5]
type = ChangeState
trigger1 = Pos Y + Vel Y > Map(StageGround)
value = 1415

;---------------------------------------------------------------------------
; Special Land
[Statedef 1415]
type    = S
movetype= I
physics = S
anim = 47
velset = Vel X * 0.5,0
movehitpersist = 1
ctrl = 0

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = Time = 8
trigger2 = Time = 4
trigger2 = PrevStateNo = 1100 || PrevStateNo = 1210
value = 1

[State 0, MapSet]
type = MapSet
trigger1 = !Time
map = "LandDustFX"
value = 1

[State 0, ChangeState]
type = ChangeState
triggerall = MoveHit && (EnemyNear,StateType = A || EnemyNear,StateType = L) || PrevStateNo = 860 || PrevStateNo = 1210
triggerall = Name = "NECC"
trigger1 = command = "holdy" && command = "holdb" || command = "holdc"
value = 900

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; QCB+LK S-L
[Statedef 1500]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 1500
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1501
v = 5
value = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimElem = 15
trigger1 = Var(5) && Time < 32
value = Anim
elem = 6

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 4
x = 8
[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 4, 1
x = 2.5 + 1.5 * Var(5)

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 8
trigger3 = AnimElem = 11
trigger4 = AnimElem = 14
value = F0, 1

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 4
v = 33
value = 1500
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 4
v = 34
value = random%5

[State 0, Explod LEG 1]
type = Explod
trigger1 = Anim = 1500 && AnimElem = 6, 3
anim = 2011
postype = p1
sprpriority = 3
[State 0, Explod LEG 2]
type = Explod
trigger1 = Anim = 1500 && AnimElem = 9, 3
anim = 2012
postype = p1
sprpriority = 3
[State 0, Explod LEG 3]
type = Explod
trigger1 = Anim = 1500 && AnimElem = 12, 3
anim = 2013
postype = p1
sprpriority = 3

[State 0, Var Damage Value]
type = VarSet
triggerall = AnimElemNo(0) < 15
trigger1 = !MoveContact && !MoveReversed
trigger2 = Var(8) > 1
v = 12
value = 40 - 16 * (MoveContact>0) - 8 * (MoveContact>0&&Var(5))
ignorehitpause = 1
[State 0, Var Damage Value]
type = VarSet
trigger1 = AnimElem = 15
v = 12
value = 32
ignorehitpause = 1

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed && AnimElemNo(0) < 15
trigger2 = AnimElem = 6
trigger3 = AnimElem = 9
trigger4 = AnimElem = 12
trigger5 = AnimElem = 15 && !Var(5) && Var(10) != 2 && Var(11) <= 1
attr = S,SA
hitflag = MAF
guardflag = MA
animtype = medium
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(152*(1.0/7.0)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleMulti))
pausetime = 2,2
sparkno = random%4 + (Var(10)=1) * 5
guard.sparkno = var(19)
sparkxy = -8+Floor(P2Dist X*0.5)-random%41,-16+Floor(P2Dist Y*0.5)-random%41
hitsound = 1,1
guardsound = 5,0
ground.type = Low
ground.slidetime = 20
ground.hittime = 20
guard.hittime = 12 + 2 * !Var(5)
yaccel = 0.5
air.fall = 1
ground.velocity = -2 + P2Dist X * 0.04,0
air.velocity = -1 + P2Dist X * 0.02,-1.5
guard.velocity = -1 + P2Dist X * 0.02
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State 0, HitDef]
type = HitDef
trigger1 = AnimElem = 15 && (Var(5) || Var(10) = 2 || Var(11) > 1)
attr = S,SA
hitflag = MAF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(152*(1.0/7.0)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleLight))
pausetime = 12,12+Var(13)
guard.pausetime = 12,12
sparkno = ifelse((Var(10)=2||Var(11)>=2),30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = var(19)
sparkxy = -24+Floor(P2Dist X*0.5),-32+Floor(P2Dist Y*0.5)
hitsound = 1,3
guardsound = 5,0
ground.type = Low
ground.slidetime = 20
ground.hittime = 20
guard.hittime = 12 + 2 * !Var(5)
yaccel = 0.5
fall = 1
ground.velocity = -2,-4.5
air.velocity = -1,-3.5
guard.velocity = -4
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, Var Dull Dire]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
triggerall = Var(10) = 2
trigger1 = Var(8) = 1 && AnimElemNo(0) < 15
var(11) = 2
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
triggerall = Var(10) = 2 || Var(11) > 1
trigger1 = Var(8) = 1
trigger1 = AnimElemNo(0) >= 15
map = "DireAct"
value = 5340
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 16
movetype = I

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; QCB+SK S-L
[Statedef 1501]
type    = S
movetype= A
physics = S
ctrl = 0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1500

;---------------------------------------------------------------------------
; ju.QCB+LK S-L
[Statedef 1550]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1550
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1551
v = 5
value = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimElem = 12
trigger1 = Var(5) && Time < 32
value = Anim
elem = 3

[State 0, VelMul]
type = VelMul
trigger1 = !Time
x = 0.333
y = 0.125
[State 0, VelSet]
type = VelSet
trigger1 = !Time && Var(5)
x = Vel X + 0.5
y = -1.5 + Vel Y * 0.25; - Pos Y * 0.01
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) <= 12
y = 0.05

[State 0, Explod LEG 1]
type = Explod
trigger1 = Anim = 1550 && AnimElem = 3, 3
anim = 2011
postype = p1
sprpriority = 3
[State 0, Explod LEG 2]
type = Explod
trigger1 = Anim = 1550 && AnimElem = 6, 3
anim = 2012
postype = p1
sprpriority = 3
[State 0, Explod LEG 3]
type = Explod
trigger1 = Anim = 1550 && AnimElem = 9, 3
anim = 2013
postype = p1
sprpriority = 3

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 5
trigger3 = AnimElem = 8
trigger4 = AnimElem = 11
value = F0, 1

[State 0, Var Voice Bank]
type = VarSet
trigger1 = !Time
v = 33
value = 1500
[State 0, Var Voice Variant]
type = VarSet
trigger1 = !Time
v = 34
value = random%5

[State 0, Var Damage Value]
type = VarSet
triggerall = AnimElemNo(0) < 12
trigger1 = !MoveContact && !MoveReversed
trigger2 = Var(8) > 1
v = 12
value = 40 - 16 * (MoveContact>0) - 8 * (MoveContact>0&&Var(5))
ignorehitpause = 1
[State 0, Var Damage Value]
type = VarSet
trigger1 = AnimElem = 12
v = 12
value = 16
ignorehitpause = 1

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed && AnimElemNo(0) < 12
trigger2 = AnimElem = 3
trigger3 = AnimElem = 6
trigger4 = AnimElem = 9
trigger5 = AnimElem = 12 && !Var(5) && Var(10) != 2 && Var(11) <= 1
attr = A,SA
hitflag = MAF
guardflag = MA
animtype = medium
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(136*(1.0/7.0)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleMulti))
pausetime = 2,2
sparkno = random%4 + (Var(10)=1) * 5
guard.sparkno = var(19)
sparkxy = -8+Floor(P2Dist X*0.5)-random%41,-16+Floor(P2Dist Y*0.5)-random%41
hitsound = 1,1
guardsound = 5,0
ground.type = Low
ground.slidetime = 20
ground.hittime = 20
guard.hittime = 12
yaccel = 0.5
air.fall = 1
ground.velocity = -2 + P2Dist X * 0.04 - Vel X,0
air.velocity = -1 + P2Dist X * 0.02 - Vel X,-1.5 + Vel Y * Var(5)
guard.velocity = -2
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State 0, HitDef]
type = HitDef
trigger1 = AnimElem = 12 && (Var(5) || Var(10) = 2 || Var(11) > 1)
attr = S,SA
hitflag = MAF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(136*(1.0/7.0)*const(BC.ChipLight))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleLight))
pausetime = 12,12+Var(13)
guard.pausetime = 12,12
sparkno = ifelse((Var(10)=2||Var(11)>=2),30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = var(19)
sparkxy = -24+Floor(P2Dist X*0.5),-32+Floor(P2Dist Y*0.5)
hitsound = 1,3
guardsound = 5,0
ground.type = Low
ground.slidetime = 20
ground.hittime = 20
guard.hittime = 12
yaccel = 0.5
fall = 1
ground.velocity = -2,-7
air.velocity = -1,-5
guard.velocity = -2
p2facing = 1
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, Var Dull Dire]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
triggerall = Var(10) = 2
trigger1 = Var(8) = 1 && AnimElemNo(0) < 12
var(11) = 2
ignorehitpause = 1
[State 0, Map Dire Trigger]
type = MapSet
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
triggerall = Var(10) = 2 || Var(11) > 1
trigger1 = Var(8) = 1
trigger1 = AnimElemNo(0) = 12
map = "DireAct"
value = 5340
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 13
movetype = I
physics = A
[State 0, CtrlSet]
type = CtrlSet
trigger1 = 0;AnimElem = 13 && !Var(5)
value = 1

[State 200, 3]
type = ChangeState
trigger1 = Pos Y + Vel Y > Map(StageGround)
value = 1415

;---------------------------------------------------------------------------
; ju.QCB+SK S-L
[Statedef 1551]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1550

;---------------------------------------------------------------------------
; rDP+LP S-L
[Statedef 1600]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
movehitpersist = 1
anim = 1600
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1601
v = 5
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 6
value = 1
[State 0, VarSet]
type = VarSet
triggerall = Var(6) > 0
trigger1 = !Var(5) && command != "holdx"
trigger2 = Var(5) && command != "holdy"
v = 6
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = Var(6) > -1
trigger1 = map(b_yb)
v = 6
value = -1
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 0
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimElem = 3, 4 && !Var(6)
trigger2 = AnimElem = 3, 8 && !Var(6)
trigger3 = AnimElem = 3, 12 && !Var(6)
trigger4 = AnimElem = 3, 16 && !Var(6)
value = Anim
elem = 4
[State 0, VarAdd]
type = VarAdd
trigger1 = AnimElem = 3, 4 && Var(6)
trigger2 = AnimElem = 3, 8 && Var(6)
trigger3 = AnimElem = 3, 12 && Var(6)
trigger4 = AnimElem = 3, 16 && Var(6)
trigger5 = AnimElem = 4
v = 7
value = 1

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 4
value = F0,3
[State 0, Snd Charge]
type = PlaySnd
trigger1 = !Time
value = S1600,0
channel = 1

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 4
v = 33
value = 1600
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 4
v = 34
value = random%5

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 5
name = "OphaNIMROD"
ID = 1610
stateno = 1610
pos = 16,-52
ownpal = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 5
movetype = I
[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 10
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = AnimElemNo(0) >= 6
trigger1 = Var(6) = -1
value = 910
[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; rDP+LP S-L
[Statedef 1601]
type    = S
movetype= A
physics = S
ctrl = 0
movehitpersist = 1
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1600

;---------------------------------------------------------------------------
; H - Ophanim
[Statedef 1610]
type    = A
movetype= A
physics = N
movehitpersist = 1
sprpriority = 3

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1610
value = 1610

[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1611
v = 5
value = Parent,Var(5)
[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1611
v = 6
value = Parent,Var(7)
[State 0, VarSet]
type = VarSet
trigger1 = !Time && PrevStateNo != 1611
v = 7
value = Parent,Var(7)

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 4
trigger2 = !Time && PrevStateNo = 1611
x = (1.5 + Var(7) * 0.05) * (0.5 + 1 * Var(5))

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Parent,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact
fv = 10
value = max(Parent,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = MoveContact = 1
x = -Vel X

[State 0, VarAdd]
type = VarAdd
trigger1 = Var(8) = 1
v = 6
value = -1
ignorehitpause = 1

[State 0, Snd Release]
type = PlaySnd
trigger1 = !Time
trigger1 = PrevStateNo != 1611
value = S1600,1
channel = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = ,NA,SA,HA,NT,ST,HT
time = 666
[State 0, HitOverride]
type = HitOverride
trigger1 = !Time
attr = SCA,NP,SP,HP
stateno = stateno + 1
time = 666

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = ceil((32 + 28 * (Var(7)-Var(7)*0.25)) / (Var(7)))

[State 0, HitDef]
type = HitDef
trigger1 = Var(6)
attr = S,SP
hitflag = MAF
guardflag = MAA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10) * (0.75 + 1.25 * !(MoveHit&&NumTarget))),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 4, 12 + Root,var(13)
sparkno = -1;10 + random%4 + (Var(10)=1) * 5
guard.sparkno = 40
sparkxy = 0,0;Floor(P2Dist X*0.5),-16+Floor(P2Dist Y*0.5)
hitsound = -1;1,2
guardsound = 5,1
ground.type = Low
ground.slidetime = 6
ground.hittime = 6
guard.hittime = 6
yaccel = 0.5
fall = (Var(6)<=1&&Var(10)!=2&&Var(11)<=1)
air.fall = 1
guard.dist = 32
ground.velocity = -3,-2 * (Var(6)<=1&&Var(10)!=2&&Var(11)<=1)
air.velocity = -2,-1
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, Snd Fire]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveContact
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveContact
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,10
ignorehitpause = 1
[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,2
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse(Var(10)=2&&Var(6)<=0,30,5 + random%4 + 5 * (Var(6)<=0))
pos = 0,-P2Dist Y
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = ParentVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = ParentVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit && HitCount = 1
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = ParentVarSet
triggerall = Var(8) = 1 && Var(10)
triggerall = NumTarget && MoveHit && HitCount = 1
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = ParentVarSet
triggerall = Var(8) = 1 && HitCount = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
fv = 8
value = Parent,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Parent,FVar(8)<1,1-Parent,FVar(8),0))
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
trigger1 = Var(10) = 2
trigger1 = Var(6) <= 0
value = 5325
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Var(10) = 2
trigger1 = Var(6) <= 0
map = "DireAct"
value = 2
ignorehitpause = 1

[State 0, PalFX]
type = PalFX
trigger1 = !Time
time = 666
add = 12,12,12
sinadd = 24,24,24,4

[State 0, DestroySelf]
type = ChangeState
trigger1 = FrontEdgeDist < -64
trigger2 = Var(6) <= 0
trigger3 = MoveReversed
trigger4 = Time > 40 + 12 * Var(7)
trigger5 = Parent,MoveType = H && Parent,StateNo != [120,160]
trigger6 = Parent,Map(Cutscene) || EnemyNear,Map(Cutscene)
value = 1612

;---------------------------------------------------------------------------
; H - Ophanim Tap
[Statedef 1611]
type    = A
movetype= A
physics = N
movehitpersist = 1

[State 0, VarSet]
type = VarAdd
trigger1 = !Time
v = 6
value = -1

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1610

;---------------------------------------------------------------------------
; H - Ophanim Hit
[Statedef 1612]
type    = A
movetype= I
physics = N
anim = 666
velset = 0,0
movehitpersist = 1
hitdefpersist = 1
sprpriority = 3

[State 0, Explod]
type = Explod
trigger1 = !Time
trigger1 = !Parent,Map(Cutscene) && !EnemyNear,Map(Cutscene)
anim = 1611
pos = 0,0;ifelse(P2Dist X < 0,0,floor(p2dist x * 0.5)),0
postype = p1
sprpriority = 3

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time = 2

;---------------------------------------------------------------------------
; QCB+LP S-K
[Statedef 1700]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
movehitpersist = 1
anim = 1700
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (PrevStateNo%10)*(PrevStateNo=[1701,1703])
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 1
[State 0, VarSet]
type = VarSet
triggerall = Time = [1,8) && Var(7)
trigger1 = Var(5) = 0 && command != "holdx"
trigger2 = Var(5) = 1 && command != "holda"
trigger3 = Var(5) = 2 && command != "holdy"
trigger4 = Var(5) = 3 && command != "holdb"
v = 7
value = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0

[State 0, Var FX]
type = MapSet
trigger1 = AnimElem = 4
map = "NeccPal"
value = 8

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 4
movetype = I

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 4
v = 33
value = 1600
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 4
v = 34
value = random%5

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 4
name = "I SAW THE LIGHT IVE BEEN BAPTIZED BY THE FIRE IN YOUR TOUCH AND THE FLAME IN YOUR EYES IM BORN TO LOVE AGAIN IM A BRAND NEW MAN"
ID = 1710
stateno = 1710
pos = max(24,min(64,p2dist x)),0
postype = p1
ownpal = 1

[State 0, MapAdd]
type = MapAdd
trigger1 = AnimElem = 4
map = "NeckDoll"
value = -1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 10
value = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; QCB+LK S-K
[Statedef 1701]
type    = S
movetype= A
physics = S
movehitpersist = 1
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1700

;---------------------------------------------------------------------------
; QCB+SP S-K
[Statedef 1702]
type    = S
movetype= A
physics = S
movehitpersist = 1
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1700

;---------------------------------------------------------------------------
; QCB+SK S-K
[Statedef 1703]
type    = S
movetype= A
physics = S
movehitpersist = 1
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1700

;---------------------------------------------------------------------------
; H - Light
[Statedef 1710]
type    = A
movetype= I
physics = N
anim = 1701
sprpriority = -5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = Parent,Var(5)
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = Parent,Var(7)

[State 0, Snd Release]
type = PlaySnd
trigger1 = !Time
value = S1600,1
channel = 1

[State 0, VelSet]
type = VelSet
trigger1 = Time >= 8
trigger1 = Vel X < 4
x = min(4 + 4 * Var(7),Vel X + 0.6 - 0.55 * Var(7))

[State 0, Explod]
type = Explod
trigger1 = 1
anim = 1701 + (AnimElemNo(0))
postype = p1
bindtime = 666
removetime = 1
scale = 1,1
sprpriority = 5
ownpal = 1
trans = addalpha
alpha = 80-floor(32 * sin(Time*0.33)),176+floor(32 * sin(Time*0.33))

[State 0, VelAdd]
type = VelMul
trigger1 = FrontEdgeDist <= -8 && Vel X > 0
trigger2 = BackEdgeDist <= -8 && Vel X < 0
x = -1

[State 0, ChangeState]
type = ChangeState
trigger1 = P2Dist X <= 8 + 40 * (Var(5)=0)
trigger1 = Time > 6 + 10 * Var(7)
value = 1712 + Var(5)
[State 0, ChangeState]
type = ChangeState
trigger1 = Parent,MoveType = H && Parent,StateNo != [120,160)
trigger2 = Parent,StateNo = [2000,3000)
value = 1711

;---------------------------------------------------------------------------
; H - LightEnd
[Statedef 1711]
type    = A
movetype= I
physics = N
velset = 0,0
sprpriority = -5

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1.00 + (Time * 0.05),1.00 + (Time * 0.025)
[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256 - (32 * Time),32 * Time

[State 0, Explod]
type = Explod
trigger1 = 1
anim = 1706
postype = p1
bindtime = 666
removetime = 1
sprpriority = 5
ownpal = 1
scale = 1.00 + (Time * 0.05),1.00 + (Time * 0.025)
trans = addalpha
alpha = 80 - (10 * Time),176 + (10 * Time)

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time > 8

;---------------------------------------------------------------------------
; H - LightLPFollowup
[Statedef 1712]
type    = A
movetype= A
physics = N
sprpriority = -5

[State 0, Helper]
type = Helper
trigger1 = 1
name = "I DONT NEED NO ONE"
ID = 1710
stateno = 1720
pos = 0,0
postype = p1
ownpal = 1

[State 0, Explod B]
type = Explod
trigger1 = 1
anim = 1710
postype = p1
sprpriority = -6
ownpal = 1
[State 0, Explod F]
type = Explod
trigger1 = 1
anim = 1711
postype = p1
sprpriority = 6
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1711

;---------------------------------------------------------------------------
; H - LightLKFollowup
[Statedef 1713]
type    = A
movetype= A
physics = N
sprpriority = -5

[State 0, Helper]
type = Helper
trigger1 = 1
name = "TO TELL ME ABOUT HEAVEN"
ID = 1710
stateno = 1725
pos = 0,0
postype = p1
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1711

;---------------------------------------------------------------------------
; H - LightSPFollowup
[Statedef 1714]
type    = A
movetype= A
physics = N
sprpriority = -5

[State 0, Helper]
type = Helper
trigger1 = 1
name = "I LOOK AT MY DAUGHTER"
ID = 1710
stateno = 1730
pos = 0,0
postype = p1
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1711

;---------------------------------------------------------------------------
; H - LightSKFollowup
[Statedef 1715]
type    = A
movetype= A
physics = N
sprpriority = -5

[State 0, Helper]
type = Helper
trigger1 = 1
name = "AND I BELIEVE"
ID = 1710
stateno = 1735
pos = 0,0
postype = p1
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1711

;---------------------------------------------------------------------------
; H - LightLPProj
[Statedef 1720]
type    = A
movetype= A
physics = N
anim = 1712
sprpriority = 3

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 2
x = 1
y = -16
[State 0, VelMul]
type = VelMul
trigger1 = AnimElem = 3
y = 0.66
[State 0, VelAdd]
type = VelAdd
trigger1 = AnimElemNo(0) >= 2
y = 0.4

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 2
value = F0,3
[State 0, Snd Spit]
type = PlaySnd
trigger1 = !Time
value = S1700,6

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Root,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact
fv = 10
value = max(Root,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = ,NA,SA,HA,NT,ST,HT
time = 666
[State 0, HitOverride]
type = HitOverride
trigger1 = !Time
attr = SCA,NP,SP,HP
stateno = stateno + 1
time = 666

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 112

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = Time >= 4
attr = A,SP
hitflag = MAFD
guardflag = MA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 4, 12 + Root,var(13)
guard.pausetime = 4,12
sparkno = -1
guard.sparkno = 40
sparkxy = 0,0
hitsound = -1
guardsound = 5,1
ground.type = Low
ground.slidetime = 10
ground.hittime = 10
guard.hittime = 4
yaccel = 0.5
air.fall = 1
ground.velocity = -3,0
air.velocity = -2,-0.25
down.velocity = -2,-2
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,3
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse((Var(10)=2||Root,Var(11)>=2),30,10 + random%4)
pos = 0,-P2Dist Y
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = RootVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10)
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = RootVarSet
triggerall = Var(8) = 1 && HitCount = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
fv = 8
value = Root,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Root,FVar(8)<1,1-Root,FVar(8),0))
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
trigger1 = Var(10) =2 || Root,Var(11) >= 2 || Root,Map(NeckDollBig)
value = ifelse(Time <= 12,5335,5325)
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Root,Var(11) >= 2
map = "DireAct"
value = Root,Var(11) - 1
ignorehitpause = 1

[State 0, MapAdd]
type = RootMapAdd
triggerall = NumTarget
triggerall = MoveHit && Var(8) = 1
triggerall = Target,MoveType = H
trigger1 = Root,Map(NeckDollBig)
trigger1 = Var(10) != 2
map = "NeckDollBig"
value = -1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Root,MoveType = H && Root,StateNo != [120,160]
movetype = I

[State 0, DestroySelf]
type = ChangeState
trigger1 = FrontEdgeDist < -24
trigger2 = MoveContact
trigger3 = MoveReversed
trigger4 = Pos Y + Vel Y > Map(StageGround)
trigger5 = Root,Map(Cutscene) || EnemyNear,Map(Cutscene)
trigger6 = Root,StateNo = [2000,3000)
value = 1721

;---------------------------------------------------------------------------
; H - LightLPProjHit
[Statedef 1721]
type    = A
movetype= I
physics = N
anim = 666
velset = 0,0
movehitpersist = 1
hitdefpersist = 1
sprpriority = 3

[State 0, Snd Bones Crunchy]
type = PlaySnd
trigger1 = !Time
value = S1700,5

[State 0, Explod]
type = Explod
trigger1 = !Time
trigger1 = !Root,Map(Cutscene) && !EnemyNear,Map(Cutscene)
anim = 1713
postype = p1
vel = -4 + 8 * (Random<500),-1 - random%4
accel = 0,0.5
sprpriority = 3
removetime = 40

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time = 2

;---------------------------------------------------------------------------
; H - LightLKSaw
[Statedef 1725]
type    = A
movetype= A
physics = N
anim = 1715
sprpriority = 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
value = F0,3
[State 0, Snd Saw1]
type = PlaySnd
trigger1 = AnimElem = 3
trigger2 = AnimElem = 9
value = S1700,1
[State 0, Snd Saw2]
type = PlaySnd
trigger1 = AnimElem = 6
value = S1700,2

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Root,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact && !HitCount
fv = 10
value = max(Root,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = SCA
time = 666

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = AnimElemNo(0) = [4,11]
trigger1 = MoveType = I
trigger2 = Root,StateNo = [2000,3000)
value = Anim
elem = 13
[State 0, Explod]
type = Explod
trigger1 = AnimElem = 14
trigger1 = !Root,Map(Cutscene) && !EnemyNear,Map(Cutscene)
anim = 1716
postype = p1
vel = 1+random%5,-1 - random%4
accel = 0,0.5
sprpriority = 3
removetime = 24

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 48

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger2 = AnimElem = 8
trigger3 = AnimElem = 11
attr = S,SP
hitflag = MAF
guardflag = MAA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10) * (0.5 + 1.0 * !MoveHit)),Ceil(120*0.33*const(BC.ChipLight))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 1, 1 + Root,var(13)
guard.pausetime = 4,4
sparkno = -1
guard.sparkno = 40
sparkxy = 0,-8
hitsound = -1
guardsound = 5,1
ground.type = Low
ground.slidetime = 10
ground.hittime = 15
guard.hittime = 6
yaccel = 0.5
air.fall = 0
forcenofall = 1
ground.velocity = 3 * (AnimElemNo(0)>=11),0
air.velocity = 2 * (AnimElemNo(0)>=11),-1 - 2  * (AnimElemNo(0)>=11)
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,3
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse((Var(10)=2||Root,Var(11)>=2)&&AnimElemNo(0)>=11,30,10 + random%4)
pos = 0,-P2Dist Y - 8
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = RootVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10) && HitCount = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = RootVarSet
triggerall = Var(8) = 1 && HitCount = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
fv = 8
value = Root,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Root,FVar(8)<1,1-Root,FVar(8),0))
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
trigger1 = Var(10) =2 || Root,Var(11) >= 2 || Root,Map(NeckDollBig)
trigger1 = AnimElemNo(0) >= 11
value = 5325
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Root,Var(11) >= 2
trigger1 = AnimElemNo(0) >= 11
map = "DireAct"
value = Root,Var(11) - 1
ignorehitpause = 1

[State 0, MapAdd]
type = RootMapAdd
triggerall = NumTarget
triggerall = MoveHit && Var(8) = 1
triggerall = Target,MoveType = H
triggerall = AnimElemNo(0) >= 11
trigger1 = Root,Map(NeckDollBig)
trigger1 = Var(10) != 2
map = "NeckDollBig"
value = -1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 12
trigger2 = AnimElem = 13
trigger3 = Root,MoveType = H && Root,StateNo != [120,160)
trigger4 = Root,StateNo = [2000,3000)
movetype = I

[State 0, DestroySelf]
type = DestroySelf
trigger1 = AnimTime = 0

;---------------------------------------------------------------------------
; H - LightSPProj
[Statedef 1730]
type    = A
movetype= A
physics = N
anim = 1720
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = MoveType = A
trigger1 = EnemyNear,StateNo = [5110,5200]
v = 7
value = 1

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Root,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact
fv = 10
value = max(Root,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = -344
[State 0, VelAdd]
type = VelAdd
trigger1 = Time
y = 0.5

[State 0, Snd Fall]
type = PlaySnd
trigger1 = !Time
value = S1700,3

[State 0, Explod]
type = Explod
trigger1 = Time = 8
anim = 1722
ID = 1730
pos = 0,-Pos Y - Vel Y
postype = p1
removetime = 32
sprpriority = -9
ownpal = 1
trans = addalpha
alpha = 128,128

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = ,NA,SA,HA,NT,ST,HT
time = 666
[State 0, HitOverride]
type = HitOverride
trigger1 = !Time
attr = SCA,NP,SP,HP
stateno = stateno + 1
time = 666

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 144

[State 0, HitDef]
type = HitDef
triggerall = !Var(7)
trigger1 = !MoveContact && !MoveReversed
attr = A,SP
hitflag = MAFD
guardflag = HA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipMid))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 4, 12 + Root,var(13)
guard.pausetime = 4,12
sparkno = -1
guard.sparkno = 40
sparkxy = 0,0
hitsound = -1
guardsound = 5,1
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
guard.hittime = 8
yaccel = 0.5
air.fall = 1
ground.velocity = -4,0
air.velocity = 0,8
down.velocity = -2,-2
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
[State 0, HitDef]
type = HitDef
triggerall = Var(7)
trigger1 = !MoveContact && !MoveReversed
attr = A,SP
hitflag = MAFD
guardflag = MA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipMid))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 4, 12 + Root,var(13)
guard.pausetime = 4,12
sparkno = -1
guard.sparkno = 40
sparkxy = 0,0
hitsound = -1
guardsound = 5,1
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
guard.hittime = 8
yaccel = 0.5
air.fall = 1
ground.velocity = -4,0
air.velocity = 0,8
down.velocity = -2,-2
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,4
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse((Var(10)=2||Root,Var(11)>=2),30,15 + random%4)
pos = 0,-P2Dist Y
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = RootVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10)
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = RootVarSet
triggerall = Var(8) = 1 && HitCount = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
fv = 8
value = Root,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Root,FVar(8)<1,1-Root,FVar(8),0))
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
trigger1 = Var(10) = 2 || Root,Var(11) >= 2 || Root,Map(NeckDollBig) || EnemyNear,StateType = A
value = ifelse(Var(10)=2||Root,Var(11)>=2||Root,Map(NeckDollBig),5345,5355)
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Root,Var(11) >= 2
map = "DireAct"
value = Root,Var(11) - 1
ignorehitpause = 1

[State 0, MapAdd]
type = RootMapAdd
triggerall = NumTarget
triggerall = MoveHit && Var(8) = 1
triggerall = Target,MoveType = H
trigger1 = Root,Map(NeckDollBig)
trigger1 = Var(10) != 2
map = "NeckDollBig"
value = -1
ignorehitpause = 1

[State 0, VarSet]
type = RootVarSet
trigger1 = MoveContact
trigger2 = Pos Y + Vel Y > 0
v = 9
value = 6
ignorehitpause = 1

[State 5110, Explod HitGround]
type = Explod
trigger1 = Pos Y + Vel Y > 0
anim = F61
postype = p1
supermovetime = 666
pos = 0,-pos y
sprpriority = -9
[State 0, Snd SLAM]
type = PlaySnd
trigger1 = Pos Y + Vel Y > 0
value = F7,0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Root,MoveType = H && Root,StateNo != [120,160]
movetype = I

[State 0, DestroySelf]
type = ChangeState
trigger1 = FrontEdgeDist < -24
trigger2 = MoveContact
trigger3 = MoveReversed
trigger4 = Pos Y + Vel Y > 0
trigger5 = Root,Map(Cutscene) || EnemyNear,Map(Cutscene)
trigger6 = Root,StateNo = [2000,3000)
value = 1731

;---------------------------------------------------------------------------
; H - LightSPProjHit
[Statedef 1731]
type    = A
movetype= I
physics = N
anim = 666
velset = 0,0
movehitpersist = 1
hitdefpersist = 1
sprpriority = 3

[State 0, Explod]
type = Explod
trigger1 = !Time
trigger1 = !Root,Map(Cutscene) && !EnemyNear,Map(Cutscene)
anim = 1721
postype = p1
vel = -4 + 8 * (Random<500),-1 - random%4
accel = 0,0.5
sprpriority = 3
removetime = 40

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time = 2

;---------------------------------------------------------------------------
; H - LightSKBite
[Statedef 1735]
type    = A
movetype= A
physics = N
anim = 1725
sprpriority = 3

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Root,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact
fv = 10
value = max(Root,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, Snd Bite]
type = PlaySnd
trigger1 = AnimElem = 3
value = S1700,4
[State 0, Snd Whale]
type = PlaySnd
trigger1 = AnimElem = 2
value = S1700,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = SCA
time = 666

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 120

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = C,SP
hitflag = MAFD
guardflag = LA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 12, 12 + Root,var(13)
guard.pausetime = 12,12
sparkno = -1
guard.sparkno = 40
sparkxy = 0,0
hitsound = -1
guardsound = 5,1
ground.type = Trip
ground.slidetime = 12
ground.hittime = 12
guard.hittime = 8
yaccel = 0.5
fall = 1
fall.recovertime = 510 
ground.velocity = -1,-5
air.velocity = -1,-1.25
down.velocity = 2,-8
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, ChangeState] ;OTG
type = TargetState
triggerall = MoveHit && !MoveReversed
triggerall = NumTarget && EnemyNear,MoveType = H
trigger1 = EnemyNear,StateType = L
trigger1 = Var(8) = 1
value = 5020
ignorehitpause = 1

[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,8
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse((Var(10)=2||Root,Var(11)>=2),30,25 + random%4)
pos = 0,-P2Dist Y - 8
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = RootVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = RootVarSet
triggerall = Var(8) = 1 && Var(10)
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = RootVarSet
triggerall = Var(8) = 1 && HitCount = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
fv = 8
value = Root,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Root,FVar(8)<1,1-Root,FVar(8),0))
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
trigger1 = Var(10) = 2 || Root,Var(11) >= 2 || Root,Map(NeckDollBig)
value = 5335
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Root,Var(11) >= 2
map = "DireAct"
value = Root,Var(11) - 1
ignorehitpause = 1

[State 0, MapAdd]
type = RootMapAdd
triggerall = NumTarget
triggerall = MoveHit && Var(8) = 1
triggerall = Target,MoveType = H
trigger1 = Root,Map(NeckDollBig)
trigger1 = Var(10) != 2
map = "NeckDollBig"
value = -1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = AnimTime = 0
trigger2 = Root,StateNo = [2000,3000)
trigger3 = Root,MoveType = H && Root,StateNo != [120,160)

;---------------------------------------------------------------------------
; QCF+LP S-K
[Statedef 1800]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
movehitpersist = 1
anim = 1800
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (PrevStateNo=1801)

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 1
[State 0, VarSet]
type = VarSet
trigger1 = Time && Var(7)
trigger1 = !(Var(5) = 0 && (command = "holdx" || command = "holdz"))
trigger1 = !(Var(5) = 1 && (command = "holdy" || command = "holdc"))
v = 7
value = 0
[State 0, VarSet]
type = VarSet
trigger1 = Time && Var(7) = 1
trigger1 = map(b_a) || map(b_b)
v = 7
value = -1

[State 0, MapAdd]
type = MapAdd
trigger1 = !time || animelem = 15
map = "NeckDoll"
value = -1

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 17
x = -6
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 10
trigger2 = AnimElem = 14
trigger3 = AnimElem = 15
x = 6

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimElem = 9
trigger1 = Var(7)
value = Anim
elem = 2
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimElemNo(0) = [2,8]
trigger1 = !Var(7)
trigger1 = Time >= 8 + 8 * Var(5)
value = Anim
elem = 10
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AnimElemNo(0) = [2,8]
trigger1 = Var(7) = -1
trigger1 = Time >= 4
value = Anim
elem = 17

[State 0, Explod Rock Hold 1]
type = Explod
trigger1 = AnimElemNo(0) = 1 && AnimTime
trigger2 = AnimElemNo(0) = 10
anim = 1812
pos = 28,-48
postype = p1
removetime = 1
sprpriority = 3
[State 0, Explod Rock Hold 2]
type = Explod
trigger1 = AnimElemNo(0) = 2
trigger2 = AnimElemNo(0) = 9
anim = 1812
pos = 30,-56
postype = p1
removetime = 1
sprpriority = 3
[State 0, Explod Rock Hold 3]
type = Explod
trigger1 = AnimElemNo(0) = 3
trigger2 = AnimElemNo(0) = 8
anim = 1812
pos = 32,-54
postype = p1
removetime = 1
sprpriority = 3
[State 0, Explod Rock Hold 4]
type = Explod
trigger1 = AnimElemNo(0) = 4
anim = 1812
pos = 31,-62
postype = p1
removetime = 1
sprpriority = 3

[State 0, Explod Rock Toss]
type = Explod
trigger1 = AnimElem = 5
anim = 1813
id = 3000
pos = 28,-80
postype = p1
vel = 0,-6
accel = 0,0.95
removetime = 16
sprpriority = -1
shadow = -1

[State 0, Snd Swing]
type = PlaySnd
trigger1 = AnimElem = 13
value = F0,3

[State 0, Var Voice Bank]
type = VarSet
trigger1 = AnimElem = 10
v = 33
value = 1800
[State 0, Var Voice Variant]
type = VarSet
trigger1 = AnimElem = 10
v = 34
value = random%4

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 15
name = "STONE!"
ID = 1810
stateno = 1810
pos = max(16,min(32,p2bodydist x)) - 8 * Var(5),-56 - 8 * Var(5)
postype = p1
ownpal = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = AnimElemNo(0) = 10
trigger2 = AnimElemNo(0) = 17
id = 3000

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 15
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 16
value = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; QCF+SP S-K
[Statedef 1801]
type    = S
movetype= A
physics = S
movehitpersist = 1
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1800

;---------------------------------------------------------------------------
; H - Rock
[Statedef 1810]
type    = A
movetype= A
physics = N
anim = 1810
velset = 3 + 3 * (!Parent,Var(5)),-3 - 5 * (!!Parent,Var(5))
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = Parent,Var(5)

[State 0, VelSet]
type = VelSet
trigger1 = !Time && Var(5)
x = 0.5 + max(0,P2Dist X * 0.02)

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = 0.3 + 0.1 * Var(5)

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Parent,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact
fv = 10
value = max(Parent,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = ,NA,SA,HA,NT,ST,HT
time = 666
[State 0, HitOverride]
type = HitOverride
trigger1 = !Time
attr = SCA,NP,SP,HP
stateno = stateno + 1
time = 666

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 112

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
trigger1 = Time >= 4 * Var(5)
attr = A,SP
hitflag = MAFD
guardflag = MA
animtype = medium
priority = 5,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipLight))
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 4, 12 + Root,var(13)
guard.pausetime = 4,12
sparkno = -1
guard.sparkno = 40
sparkxy = 0,0
hitsound = -1
guardsound = 5,1
ground.type = Low
ground.slidetime = 8
ground.hittime = 8
guard.hittime = 4
yaccel = 0.5
air.fall = 1
ground.velocity = -2,0
air.velocity = -1,-2
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,3
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse((Var(10)=2||Parent,Var(11)>=2),30,10 + random%4)
pos = 0,-P2Dist Y
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = ParentVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = ParentVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = ParentVarSet
triggerall = Var(8) = 1 && Var(10)
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = ParentVarSet
trigger1 = Var(8) = 1
trigger1 = NumTarget && MoveHit
fv = 8
value = Parent,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Parent,FVar(8)<1,1-Parent,FVar(8),0))
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
trigger1 = Var(10) =2 || Parent,Var(11) >= 2 || Parent,Map(NeckDollBig)
value = 5325
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Parent,Var(11) >= 2
map = "DireAct"
value = Root,Var(11) - 1
ignorehitpause = 1

[State 0, MapAdd]
type = ParentMapAdd
triggerall = NumTarget
triggerall = MoveHit && Var(8) = 1
triggerall = Target,MoveType = H
trigger1 = Parent,Map(NeckDollBig)
map = "NeckDollBig"
value = -1
ignorehitpause = 1

[State 0, DestroySelf]
type = ChangeState
trigger1 = MoveContact
trigger2 = MoveReversed
trigger3 = Parent,Map(Cutscene) || EnemyNear,Map(Cutscene)
trigger4 = Pos Y + Vel Y > 0
trigger5 = Root,StateNo = [2000,3000)
value = 1811

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Parent,MoveType = H && Parent,StateNo != [120,160]
movetype = I

[State 0, DestroySelf]
type = DestroySelf
trigger1 = FrontEdgeDist < -24

;---------------------------------------------------------------------------
; H - Rock Hit
[Statedef 1811]
type    = A
movetype= I
physics = N
anim = 666
movehitpersist = 1
hitdefpersist = 1
sprpriority = 3

[State 0, Explod]
type = Explod
trigger1 = !Time
trigger1 = !Parent,Map(Cutscene) && !EnemyNear,Map(Cutscene)
anim = 1811
postype = p1
vel = (-Vel X) * !!MoveContact + Vel X * !MoveContact,-1 - random%4
accel = 0,0.5
sprpriority = 3
removetime = 40

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time = 2

;---------------------------------------------------------------------------
; HCF+LK
[Statedef 1850]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 1850 + (PrevStateNo=1851)
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (PrevStateNo=1851)

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 10
x = 8
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElem = 14
trigger2 = AnimElem = 17
x = -8

[State 0, Var FX]
type = MapSet
trigger1 = AnimElem = 8
map = "NeccPal"
value = 8
[State 0, MapAdd]
type = MapAdd
trigger1 = AnimElem = 8
map = "NeckDoll"
value = -1

[State 210, 1]
type = PlaySnd
trigger1 = AnimElem = 7
value = F0, 4
[State 0, Snd BONES]
type = PlaySnd
trigger1 = AnimElem = 8
value = 215,0
[State 0, Snd SNAP]
type = PlaySnd
trigger1 = AnimElem = 14
value = 2300,1

[State 0, Explod Bonedrop]
type = Explod
trigger1 = AnimElem = 14
anim = 2301
pos = 48,0
postype = p1
vel = -1+0.01*(random%201),-2
accel = 0,0.3
removetime = 96
sprpriority = 3
ownpal = 1

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 136 + 8 * Var(5)

[State 0, HitDef]
type = HitDef
trigger1 = !MoveContact && !MoveReversed
attr = S,SA
hitflag = MAF
guardflag = MA
animtype = heavy
priority = 4,Hit
damage = Ceil(Var(12) * FVar(10)),Ceil(Var(12)*const(BC.ChipMid))
guardpoints = floor((const(BC.GuardFlat) + Var(12)) * const(BC.GuardScaleMid))
pausetime = 12,12+Var(13)
guard.pausetime = 12,12
sparkno = ifelse(Var(10)=2||Var(11)>=2,30,10 + random%4 + (Var(10)=1) * 5)
guard.sparkno = 40
sparkxy = -40+Floor(P2Dist X*0.5),-40+Floor(P2Dist Y*0.5)
hitsound = 1,3
guardsound = 5,1
ground.type = Low
ground.slidetime = 22
ground.hittime = 22
guard.hittime = 13
yaccel = 0.5
air.fall = 1
ground.velocity = -6,0
air.velocity = -7,-1
guard.velocity = -4
getpower = floor(Var(12)*Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = MoveHit && Var(8) = 1
trigger1 = Target,MoveType = H && (Target,StateNo = [5000,5100))
trigger1 = Var(10) = 2 || Var(11) >= 2 || Var(5) || EnemyNear,StateType != A || Map(NeckDollBig)
value = ifelse(Var(10)=2||Var(11)>=2||Var(5)&&EnemyNear,StateType!=A||Map(NeckDollBig),5340,5350)
ignorehitpause = 1
[State 0, Dire Counter Stack Reduce]
type = VarAdd
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(11) > 1 && Var(8) = 1
v = 11
value = -1
ignorehitpause = 1
[State 0, Var Dire Counter Stack On]
type = VarSet
triggerall = MoveHit && !MoveReversed
triggerall = EnemyNear,MoveType = H
trigger1 = Var(8) = 1 && Var(10) = 2
v = 11
value = 2
ignorehitpause = 1

[State 0, MapAdd]
type = MapAdd
triggerall = NumTarget
triggerall = MoveHit && Var(8) = 1
triggerall = Target,MoveType = H
trigger1 = Map(NeckDollBig) && EnemyNear,StateNo = [5340,5341]
trigger1 = !Var(5) || EnemyNear,Pos Y != 0
map = "NeckDollBig"
value = -1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 11
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = AnimElem = 15
value = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HCF+SK
[Statedef 1851]
type    = S
movetype= A
physics = S
ctrl = 0
sprpriority = 2

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1850

;---------------------------------------------------------------------------
; 5KK
[Statedef 1900]
type    = U
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = !Time && Pos Y < 0
trigger2 = AnimElem = 7
statetype = A
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = !Time && Pos Y >= 0
statetype = S

[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 1
value = (StateType=S)
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 5
value = (PrevStateNo%10)*(PrevStateNo=[1900,1910))
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 6
value = 24
[State 0, VarSet]
type = VarSet
trigger1 = !Time
v = 7
value = 0

[State 0, Snd Swing]
type = PlaySnd
triggerall = Anim = [1900,1903]
trigger1 = AnimElem = 3
value = S215,0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = AnimElemNo(0) >= 4
value = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Var(5) > 1
value = 5
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Var(5) <= 1
trigger2 = Anim = 5 && Time >= 2
value = 1900 + (Var(5)%2) + 2 * (StateType=A)
[State 0, Turn]
type = Turn
triggerall = P2Dist X < 0
trigger1 = Var(6) <= 16 && Anim = [1900,1903] && AnimElemNo(0) >= 7
trigger2 = Abs(Var(7)) <= 16 && (Anim = 1901||Anim=1903) && AnimElemNo(0) >= 7
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Var(6) <= 16 && Anim = [1900,1903] && AnimElemNo(0) >= 7
trigger2 = Abs(Var(7)) <= 16 && (Anim = 1901||Anim=1903) && AnimElemNo(0) >= 7
value = 41
elem = 6

[State 0, Turn]
type = Turn
trigger1 = !Time && Var(5) > 1

[State 0, Helper]
type = Helper
triggerall = Anim = [1900,1903]
trigger1 = AnimElem = 4
name = "useful for finishing swamp palace"
ID = 1905
stateno = 1905
pos = Var(6),Var(7)-52 - 19 * (Anim=1901)
postype = p1
ownpal = 1
[State 0, Explod]
type = Explod
triggerall = Anim = [1900,1903]
trigger1 = AnimElemNo(0) >= 4
anim = 1911 + (AnimElemNo(0)>=7)
ID = 3000
pos = Var(6),Var(7)-51.5 - 19 * (Anim=1901) + 14 * (Anim=1903)
postype = p1
;vfacing = ifelse(Var(5)%2,-1,1)
removetime = 1
sprpriority = -4
angle = 35*(Anim=1901)+325*(Anim=1903)
shadow = -1
[State 0, Explod]
type = Explod
triggerall = Anim = [1900,1903]
trigger1 = AnimElemNo(0) >= 4
anim = 1910
ID = 3000
pos = Var(6),Var(7)-51 - 19 * (Anim=1901) + 14 * (Anim=1903)
postype = p1
;vfacing = ifelse(Var(5)%2,-1,1)
removetime = 1
sprpriority = -5
scale = 0.1*Var(6)+0.025*Abs(Var(7)),0.25
angle = 35*(Anim=1901)+325*(Anim=1903)
shadow = -1

[State 0, MapAdd]
type = MapAdd
trigger1 = AnimElem = 4
map = "NeckDoll"
value = -1

[State 0, PosSet]
type = VelSet
triggerall = Anim = [1900,1903]
trigger1 = AnimElem = 7 
x = Var(6) * 0.1
y = Var(7) * 0.12
[State 0, VelMul]
type = VelMul
triggerall = Anim = [1900,1903]
trigger1 = AnimElemNo(0) >= 7 
x = 0.925
y = 0.925
[State 0, VarSet]
type = VarSet
triggerall = Anim = [1900,1903]
trigger1 = AnimElemNo(0) >= 7
v = 6
value = ceil(Var(6) - Vel X)
[State 0, VarSet]
type = VarSet
triggerall = Anim = [1900,1903]
trigger1 = AnimElemNo(0) >= 7
v = 7
value = ceil(Var(7) - Vel Y)

[State 0, VelMul]
type = VelMul
trigger1 = Var(6) <= 16 && Anim = [1900,1903] && AnimElemNo(0) >= 7
trigger2 = Abs(Var(7)) <= 16 && (Anim = 1901||Anim=1903) && AnimElemNo(0) >= 7
x = 0.25
y = 0.275
[State 0, CtrlSet]
type = CtrlSet
trigger1 = Anim = 41 && !Ctrl
value = 1
[State 0, VelAdd]
type = VelAdd
trigger1 = Anim = 41
y = 0.5

[State 0, VelMul]
type = VelMul
trigger1 = Vel Y > 0
trigger1 = Pos Y + Vel Y > Map(StageGround)
x = 0.5
[State 0, ChangeState]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y + Vel Y > Map(StageGround)
value = 1915

;---------------------------------------------------------------------------
; 2KK
[Statedef 1901]
type    = U
movetype= A
physics = N
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1900

;---------------------------------------------------------------------------
; 4KK
[Statedef 1902]
type    = U
movetype= A
physics = N
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1900

;---------------------------------------------------------------------------
; 1KK
[Statedef 1903]
type    = U
movetype= A
physics = N
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !Time
value = 1900

;---------------------------------------------------------------------------
; H - Hook
[Statedef 1905]
type    = A
movetype= I
physics = N
anim = 1905

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "%f %f"
params = ParentDist X,ParentDist Y
ignorehitpause = 1

[State 0, VarAdd]
type = ParentVarAdd
trigger1 = !MoveContact
v = 6
value = 12
[State 0, VarAdd]
type = ParentVarAdd
trigger1 = !MoveContact
v = 7
value = -(8 + Gametime%2) * (Parent,Var(5)%2) * (1-2*(Parent,StateType=A))

[State 0, PosSet]
type = PosSet
trigger1 = !MoveContact
x = 2*Parent,Pos X + Parent,Var(6) * Facing
y = 2*Parent,Pos Y + Parent,Var(7) - 52

[State 0, PosAdd]
type = PosAdd
trigger1 = FrontEdgeDist < 0
x = FrontEdgeDist
[State 0, PosAdd]
type = PosAdd
trigger1 = Pos Y > 0
y = -Pos Y
[State 0, PosAdd]
type = PosAdd
trigger1 = ScreenPos Y < 0
y = -ScreenPos Y

[State 0, ParentVarSet]
type = ParentVarSet
trigger1 = MoveContact
v = 6
value = -ParentDist X
ignorehitpause = 1
[State 0, ParentVarSet]
type = ParentVarSet
trigger1 = MoveContact
v = 7
value = -ParentDist Y + 52
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !MoveContact && Time < 64
trigger1 = Parent,AnimElemNo(0) = 6
value = Parent,Anim
elem = 6
ignorehitpause = 1
redirectid = Parent,ID

[State 0, Counter Check Reset]
type = VarSet
trigger1 = !MoveContact
v = 10
value = Parent,Var(10) * !Root,Var(51)
ignorehitpause = 1
[State 0, Scaling Reset]
type = VarSet
trigger1 = !MoveContact
fv = 10
value = max(Parent,FVar(8) + (Var(10)=1)*const(BC.CounterBonus),const(BC.ScalingMin))
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = !Time
name = "peter pan reference? look i dunno"
stateno = 1907
postype = p1
[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = ,NA,SA,HA,NT,ST,HT,NP,SP,HP
time = 666

[State 0, Var Damage Value]
type = VarSet
trigger1 = !Time
v = 12
value = 8

[State 0, HitDef]
type = HitDef
triggerall = Parent,Anim = 1900 || Parent,StateType = A && EnemyNear,StateType != A
trigger1 = !MoveContact && !MoveReversed
attr = S,SP
hitflag = MD
guardflag = MA
animtype = light
priority = 5,Hit
damage = Var(12),0
guardpoints = floor((32 + Var(12)) * 0.5)
pausetime = 1, 12
sparkno = -1
guard.sparkno = 40
sparkxy = 0,0
hitsound = -1
guardsound = 5,1
ground.type = Low
ground.slidetime = 16
ground.hittime = 16
guard.hittime = 10
ground.velocity = -2,0
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
[State 0, HitDef]
type = HitDef
triggerall = Parent,Anim != 1900 && EnemyNear,StateType = A
trigger1 = !MoveContact && !MoveReversed
attr = A,SP
hitflag = AF
animtype = light
priority = 5,Hit
damage = Var(12),0
pausetime = 1, 12
sparkno = -1
sparkxy = 0,0
hitsound = -1
ground.type = Low
ground.slidetime = 14
ground.hittime = 14
yaccel = 0.5
air.fall = 1
air.velocity = -1,0
getpower = floor(Var(12)*Root,Map(ScaledPowerGetHit)),floor(Var(12)*const(BC.PowerGetGuard))
givepower = floor(Var(12)*Root,Map(ScaledPowerGiveHit)),floor(Var(12)*const(BC.PowerGiveGuard))
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0

[State 0, Snd Hit]
type = PlaySnd
triggerall = Var(8) = 1
trigger1 = !NumTarget && MoveHit
trigger1 = TeamSide = 1
trigger2 = NumTarget && MoveHit
trigger3 = gethitvar(damage) > 0
trigger3 = TeamSide = 1
value = F1,2
ignorehitpause = 1

[State 0, Explod HitSpark]
type = Explod
triggerall = Var(8) = 1
trigger1 = NumTarget && MoveHit && !MoveReversed
anim = F ifelse((Var(10)=2||Parent,Var(11)>=2),30,random%4)
pos = 0,-P2Dist Y
postype = p2
pausemovetime = 666
supermovetime = 666
sprpriority = 9
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, HitAdd]
type = ParentVarAdd
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 51
value = 1
ignorehitpause = 1

[State 0, Var Dire Counter Stack On]
type = ParentVarSet
triggerall = Var(8) = 1 && Var(10) = 2
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 11
value = 3
ignorehitpause = 1

[State 0, ParentVarSet Counter Message]
type = ParentVarSet
triggerall = Var(8) = 1 && Var(10)
triggerall = NumTarget && MoveHit
trigger1 = Target,StateNo = [5000,5100) && Target,StateNo%10 = 0
v = 32
value = 63 + (Var(10) = 2) + (Var(10) = 3) * 10
ignorehitpause = 1

[State 0, Dampening S]
type = ParentVarSet
trigger1 = Var(8) = 1
trigger1 = NumTarget && MoveHit
fv = 8
value = Parent,FVar(8)*(const(BC.ScalingH1) + const(BC.ScalingH2) * ifelse(Parent,FVar(8)<1,1-Parent,FVar(8),0))
ignorehitpause = 1

[State 0, Map Dire Trigger]
type = RootMapSet
triggerall = Var(8) = 1
triggerall = NumTarget && MoveHit
trigger1 = Parent,Var(11) >= 2
map = "DireAct"
value = Root,Var(11) - 1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
triggerall = Time >= 1
trigger1 = Parent,StateNo != 1900
trigger2 = Parent,AnimElemNo(0) >= 7
trigger3 = MoveContact
trigger4 = FrontEdgeDist <= 0
trigger5 = Var(7) + Pos Y >= -26
trigger6 = ScreenPos Y <= 0

;---------------------------------------------------------------------------
; H - Hook Blocker
[Statedef 1907]
type    = S
movetype= I
physics = N
anim = 1905

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause = 1
[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
pos = 0,0
ignorehitpause = 1
[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = ,NA,SA,HA,NT,ST,HT
time = 2
ignorehitpause = 1
[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NP,SP,HP
stateno = stateno
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Parent,StateNo != 1905
trigger2 = Root,StateNo != 1900
ignorehitpause = 1

;---------------------------------------------------------------------------
; Safe Land
[Statedef 1915]
type    = S
movetype= A
physics = S
anim = 47
velset = Vel X * 0.5,0
movehitpersist = 1
ctrl = 0

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = Time = 4
value = 1

[State 0, MapSet]
type = MapSet
trigger1 = !Time
map = "LandDustFX"
value = 1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1